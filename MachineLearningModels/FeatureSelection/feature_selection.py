import pandas as pd
from sklearn.feature_selection import SelectKBest
from sklearn.feature_selection import chi2, f_classif
from sklearn.model_selection import train_test_split

# Load your dataset
# Replace 'your_dataset.csv' with the actual filename or URL of your dataset
df = pd.read_csv('/Users/khushbeen/PycharmProjects/StaticAndroidMalwareAnalysis/MachineLearningModels/FeatureSelection/Resources/qa_dataset.csv')

# Drop the 'sha256' column
df = df.drop(columns=['sha256'])

# Assume 'target' is the column you want to predict
X = df.drop(columns=['Malware'])
y = df['Malware']

# Split the data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=42)

selector = SelectKBest(chi2, k=10)  # For chi-squared test

# Fit the selector to the training data
X_train_selected = selector.fit_transform(X_train, y_train)

# Get the indices of the selected features
selected_indices = selector.get_support(indices=True)

# Get the names of the selected features
selected_features = X.columns[selected_indices]

# Display the selected features
print("Selected Features:")
print(selected_features)
print(len(selected_features))
