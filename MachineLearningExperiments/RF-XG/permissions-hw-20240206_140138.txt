Train set size: (9000, 136).
Test set size: (1000, 136).
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
There are 0 constant categorical features and we remove them!
Removed features are: [].
['sha256' 'Malware' 'android.permission.POST_NOTIFICATIONS'
 'android.permission.ACCEPT_HANDOVER'
 'android.permission.ACCESS_BACKGROUND_LOCATION'
 'android.permission.ACCESS_COARSE_LOCATION'
 'android.permission.ACCESS_FINE_LOCATION'
 'android.permission.ACCESS_MEDIA_LOCATION'
 'android.permission.ACTIVITY_RECOGNITION'
 'com.android.voicemail.permission.ADD_VOICEMAIL'
 'android.permission.ANSWER_PHONE_CALLS'
 'android.permission.BLUETOOTH_ADVERTISE'
 'android.permission.BLUETOOTH_CONNECT'
 'android.permission.BLUETOOTH_SCAN' 'android.permission.BODY_SENSORS'
 'android.permission.BODY_SENSORS_BACKGROUND'
 'android.permission.CALL_PHONE' 'android.permission.CAMERA'
 'android.permission.GET_ACCOUNTS'
 'android.permission.NEARBY_WIFI_DEVICES'
 'android.permission.PROCESS_OUTGOING_CALLS'
 'android.permission.READ_CALENDAR' 'android.permission.READ_CALL_LOG'
 'android.permission.READ_CONTACTS'
 'android.permission.READ_EXTERNAL_STORAGE'
 'android.permission.READ_MEDIA_AUDIO'
 'android.permission.READ_MEDIA_IMAGES'
 'android.permission.READ_MEDIA_VIDEO'
 'android.permission.READ_MEDIA_VISUAL_USER_SELECTED'
 'android.permission.READ_PHONE_NUMBERS'
 'android.permission.READ_PHONE_STATE' 'android.permission.READ_SMS'
 'android.permission.RECEIVE_MMS' 'android.permission.RECEIVE_SMS'
 'android.permission.RECEIVE_WAP_PUSH' 'android.permission.RECORD_AUDIO'
 'android.permission.SEND_SMS' 'android.permission.USE_SIP'
 'android.permission.UWB_RANGING' 'android.permission.WRITE_CALENDAR'
 'android.permission.WRITE_CALL_LOG' 'android.permission.WRITE_CONTACTS'
 'android.permission.WRITE_EXTERNAL_STORAGE'
 'android.permission.BIND_DEVICE_ADMIN'
 'android.permission.SYSTEM_ALERT_WINDOW'
 'android.permission.IND_ACCESSIBILITY_SERVICE'
 'android.permission.BIND_NOTIFICATION_LISTENER_SERVICE'
 'android.permission.ACCESS_WIFI_STATE'
 'android.permission.CHANGE_NETWORK_STATE'
 'android.permission.CHANGE_WIFI_STATE'
 'android.permission.DISABLE_KEYGUARD' 'android.permission.GET_TASKS'
 'android.permission.INSTALL_PACKAGES'
 'com.android.browser.permission.READ_HISTORY_BOOKMARKS'
 'android.permission.READ_LOGS'
 'android.permission.RECEIVE_BOOT_COMPLETED'
 'android.permission.RESTART_PACKAGES' 'android.permission.SET_WALLPAPER'
 'android.permission.WRITE_APN_SETTINGS'
 'android.permission.WRITE_SETTINGS' 'android.hardware.audio.low_latency'
 'android.hardware.audio.output' 'android.hardware.audio.pro'
 'android.hardware.microphone' 'android.hardware.bluetooth'
 'android.hardware.bluetooth_le' 'android.hardware.camera'
 'android.hardware.camera.any' 'android.hardware.camera.autofocus'
 'android.hardware.camera.capability.manual_post_processing'
 'android.hardware.camera.capability.manual_sensor'
 'android.hardware.camera.capability.raw'
 'android.hardware.camera.external' 'android.hardware.camera.flash'
 'android.hardware.camera.front' 'android.hardware.camera.level.full'
 'android.hardware.type.automotive' 'android.hardware.type.television'
 'android.hardware.type.watch' 'android.hardware.fingerprint'
 'android.hardware.gamepad' 'android.hardware.consumerir'
 'android.hardware.location' 'android.hardware.location.gps'
 'android.hardware.location.network' 'android.hardware.nfc'
 'android.hardware.nfc.hce' 'android.hardware.opengles.aep'
 'android.hardware.sensor.accelerometer'
 'android.hardware.sensor.ambient_temperature'
 'android.hardware.sensor.barometer' 'android.hardware.sensor.compass'
 'android.hardware.sensor.gyroscope'
 'android.hardware.sensor.hifi_sensors'
 'android.hardware.sensor.heartrate'
 'android.hardware.sensor.heartrate.ecg' 'android.hardware.sensor.light'
 'android.hardware.sensor.proximity'
 'android.hardware.sensor.relative_humidity'
 'android.hardware.sensor.stepcounter'
 'android.hardware.sensor.stepdetector'
 'android.hardware.screen.landscape' 'android.hardware.screen.portrait'
 'android.hardware.telephony' 'android.hardware.telephony.cdma'
 'android.hardware.telephony.gsm' 'android.hardware.faketouch'
 'android.hardware.faketouch.multitouch.distinct'
 'android.hardware.faketouch.multitouch.jazzhand'
 'android.hardware.touchscreen' 'android.hardware.touchscreen.multitouch'
 'android.hardware.touchscreen.multitouch.distinct'
 'android.hardware.touchscreen.multitouch.jazzhand'
 'android.hardware.usb.accessory' 'android.hardware.usb.host'
 'android.hardware.vulkan.compute' 'android.hardware.vulkan.level'
 'android.hardware.vulkan.version' 'android.hardware.wifi'
 'android.hardware.wifi.direct' 'android.software.sip'
 'android.software.sip.voip' 'android.software.webview'
 'android.software.input_methods' 'android.software.backup'
 'android.software.device_admin' 'android.software.managed_users'
 'android.software.securely_removes_users'
 'android.software.verified_boot' 'android.software.midi'
 'android.software.print' 'android.software.leanback'
 'android.software.live_tv' 'android.software.app_widgets'
 'android.software.home_screen' 'android.software.live_wallpaper']
Fitting 5 folds for each of 150 candidates, totalling 750 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 40, 'min_samples_split': 5, 'n_estimators': 500}
Training Accuracy: 0.7295555555555555, Test Accuracy: 0.493
Training Precision: 0.6547797422834881, Test Precision: 0.155668358714044
Training Recall: 0.9711111111111111, Test Recall: 0.92
Training F1 Score: 0.7821729013781994, Test F1 Score: 0.2662807525325615
Training ROC-AUC: 0.8493062716049382, Test ROC-AUC: 0.7909055555555556
Training Confusion Matrix:
[[2196 2304]
 [ 130 4370]]
Test Confusion Matrix:
[[401 499]
 [  8  92]]
              precision    recall  f1-score   support

      Benign       0.98      0.45      0.61       900
     Malware       0.16      0.92      0.27       100

    accuracy                           0.49      1000
   macro avg       0.57      0.68      0.44      1000
weighted avg       0.90      0.49      0.58      1000

              precision    recall  f1-score   support

      Benign       0.94      0.49      0.64      4500
     Malware       0.65      0.97      0.78      4500

    accuracy                           0.73      9000
   macro avg       0.80      0.73      0.71      9000
weighted avg       0.80      0.73      0.71      9000

Indices of False Positives (FP): [0, 1, 2, 3, 5, 6, 7, 9, 11, 12, 15, 16, 19, 21, 22, 24, 25, 30, 31, 32, 33, 35, 36, 37, 39, 41, 44, 47, 48, 50, 51, 53, 54, 56, 57, 58, 59, 60, 63, 67, 68, 71, 72, 74, 75, 77, 78, 79, 81, 83, 89, 90, 92, 95, 97, 98, 99, 104, 108, 110, 111, 113, 115, 116, 119, 120, 121, 122, 123, 125, 126, 127, 128, 130, 131, 132, 134, 136, 137, 138, 139, 142, 143, 144, 147, 149, 150, 156, 157, 158, 164, 168, 169, 172, 176, 178, 179, 180, 181, 183, 185, 187, 193, 194, 196, 198, 199, 200, 201, 202, 203, 204, 205, 211, 213, 214, 215, 217, 220, 226, 230, 234, 236, 238, 241, 242, 245, 246, 248, 253, 254, 256, 259, 260, 262, 264, 265, 267, 268, 270, 271, 273, 274, 275, 277, 278, 280, 281, 283, 284, 285, 287, 288, 293, 294, 295, 297, 300, 301, 302, 303, 304, 307, 309, 310, 311, 313, 314, 315, 318, 319, 320, 321, 322, 323, 325, 331, 336, 339, 341, 348, 350, 352, 356, 357, 358, 361, 366, 367, 369, 370, 373, 374, 375, 376, 377, 379, 381, 383, 384, 387, 391, 394, 396, 398, 400, 401, 403, 405, 407, 409, 410, 412, 414, 415, 416, 417, 418, 419, 421, 422, 423, 425, 426, 428, 432, 434, 437, 440, 443, 446, 447, 449, 450, 452, 455, 457, 458, 461, 464, 465, 469, 470, 471, 474, 479, 480, 484, 485, 486, 489, 491, 497, 498, 500, 501, 502, 504, 507, 509, 510, 512, 513, 514, 517, 520, 522, 523, 524, 527, 528, 530, 531, 534, 536, 537, 538, 540, 541, 543, 546, 550, 552, 554, 556, 557, 558, 559, 560, 562, 563, 565, 566, 567, 568, 570, 571, 576, 577, 579, 583, 584, 585, 590, 591, 592, 593, 597, 598, 599, 600, 601, 602, 603, 606, 608, 609, 610, 611, 613, 619, 625, 626, 633, 634, 635, 636, 638, 642, 645, 648, 649, 653, 661, 663, 666, 667, 669, 670, 672, 675, 676, 677, 679, 680, 682, 686, 691, 692, 693, 694, 695, 696, 697, 699, 701, 703, 706, 707, 711, 712, 713, 717, 718, 719, 721, 724, 725, 727, 733, 735, 737, 738, 739, 740, 742, 747, 748, 750, 752, 753, 756, 757, 758, 759, 761, 762, 766, 769, 770, 772, 773, 774, 778, 780, 782, 783, 785, 787, 788, 789, 791, 795, 798, 800, 802, 803, 806, 807, 808, 814, 817, 818, 819, 824, 825, 827, 828, 831, 834, 835, 842, 846, 847, 848, 849, 850, 852, 857, 859, 860, 863, 864, 865, 867, 868, 870, 871, 873, 877, 883, 884, 888, 892, 894, 896, 897, 900, 903, 904, 905, 906, 907, 908, 909, 910, 911, 913, 915, 920, 922, 923, 927, 931, 933, 934, 937, 938, 939, 942, 943, 944, 946, 948, 949, 952, 953, 958, 959, 960, 961, 963, 965, 966, 967, 968, 969, 973, 975, 981, 983, 984, 986, 989, 990, 991, 993, 995, 997]
Number of False Positives (FP): 499
Indices of False Negatives (FN): [212, 349, 472, 475, 508, 518, 662, 746]
Number of False Negatives (FN): 8
Indices of True Negatives (TN): [4, 8, 10, 17, 18, 20, 23, 26, 34, 40, 42, 45, 49, 52, 55, 61, 62, 64, 65, 66, 69, 70, 73, 76, 80, 82, 84, 85, 87, 88, 91, 93, 94, 96, 100, 101, 103, 105, 106, 114, 118, 124, 129, 135, 140, 141, 146, 148, 151, 153, 155, 159, 160, 161, 162, 163, 165, 166, 167, 170, 171, 174, 175, 177, 182, 184, 186, 189, 191, 192, 195, 197, 206, 208, 209, 210, 216, 219, 221, 223, 224, 225, 227, 229, 232, 233, 235, 239, 240, 243, 244, 247, 249, 250, 252, 255, 261, 263, 266, 269, 276, 279, 282, 286, 291, 292, 298, 299, 306, 312, 316, 317, 324, 326, 327, 328, 329, 330, 332, 333, 334, 335, 337, 338, 340, 342, 343, 344, 345, 346, 351, 353, 354, 355, 359, 360, 362, 363, 364, 365, 368, 371, 372, 380, 382, 386, 389, 390, 392, 393, 395, 397, 402, 404, 408, 413, 420, 424, 427, 429, 430, 431, 433, 435, 436, 438, 439, 441, 444, 445, 448, 451, 453, 454, 456, 459, 460, 462, 466, 467, 468, 473, 478, 481, 482, 483, 487, 488, 490, 492, 493, 494, 495, 496, 499, 506, 511, 515, 516, 519, 521, 525, 526, 529, 532, 533, 535, 539, 542, 544, 547, 548, 549, 551, 553, 564, 572, 573, 574, 578, 580, 581, 582, 586, 587, 588, 589, 594, 595, 596, 604, 607, 612, 614, 615, 617, 621, 622, 623, 624, 629, 631, 632, 640, 641, 644, 647, 650, 651, 652, 655, 656, 658, 660, 664, 665, 668, 671, 673, 674, 681, 683, 684, 685, 687, 688, 689, 690, 698, 700, 702, 704, 705, 708, 710, 714, 715, 716, 722, 723, 726, 728, 729, 730, 731, 736, 741, 744, 745, 751, 755, 760, 763, 764, 765, 768, 771, 775, 776, 777, 779, 781, 784, 790, 796, 797, 799, 804, 805, 809, 810, 811, 812, 813, 815, 820, 821, 822, 823, 826, 829, 830, 832, 833, 836, 838, 839, 840, 841, 843, 844, 845, 851, 853, 854, 855, 856, 858, 861, 862, 866, 869, 874, 876, 878, 879, 880, 881, 882, 885, 886, 887, 889, 890, 891, 893, 895, 898, 901, 902, 912, 914, 918, 919, 921, 924, 925, 926, 928, 929, 930, 932, 935, 936, 940, 947, 950, 951, 954, 955, 956, 957, 962, 964, 971, 972, 974, 976, 977, 978, 979, 980, 982, 985, 987, 988, 992, 994, 996, 998, 999]
Number of True Negatives (TN): 401
Indices of True Positives (TP): [13, 14, 27, 28, 29, 38, 43, 46, 86, 102, 107, 109, 112, 117, 133, 145, 152, 154, 173, 188, 190, 207, 218, 222, 228, 231, 237, 251, 257, 258, 272, 289, 290, 296, 305, 308, 347, 378, 385, 388, 399, 406, 411, 442, 463, 476, 477, 503, 505, 545, 555, 561, 569, 575, 605, 616, 618, 620, 627, 628, 630, 637, 639, 643, 646, 654, 657, 659, 678, 709, 720, 732, 734, 743, 749, 754, 767, 786, 792, 793, 794, 801, 816, 837, 872, 875, 899, 916, 917, 941, 945, 970]
Number of True Positives (TP): 92
Filtered FN indices: [212, 349, 472, 475, 508, 518, 662, 746]
Number of filtered FNs: 8
Filtered FP indices: [6, 115, 131, 150, 169, 172, 267, 301, 302, 303, 313, 321, 394, 428, 479, 480, 497, 523, 559, 577, 584, 609, 666, 667, 712, 724, 753, 817, 852, 896, 905, 946, 975]
Number of filtered FPs: 33
--------------------Permutation importance for RF ------------------------
Baseline Recall: 0.92
<class 'numpy.ndarray'>
android.permission.WRITE_EXTERNAL_STORAGE: 0.22466666666666668
android.permission.ACCESS_WIFI_STATE: 0.17866666666666667
android.permission.READ_EXTERNAL_STORAGE: 0.16233333333333336
android.permission.ACCESS_FINE_LOCATION: 0.15100000000000005
android.permission.READ_PHONE_STATE: 0.14300000000000004
android.permission.CAMERA: 0.13300000000000003
android.hardware.camera.autofocus: 0.10633333333333336
android.hardware.camera: 0.10533333333333336
android.permission.CHANGE_WIFI_STATE: 0.07900000000000004
android.permission.RECORD_AUDIO: 0.06100000000000005
android.permission.GET_TASKS: 0.06033333333333338
android.permission.READ_CONTACTS: 0.05600000000000005
android.permission.GET_ACCOUNTS: 0.051000000000000045
android.hardware.location.gps: 0.04433333333333337
android.hardware.telephony: 0.037333333333333364
android.hardware.location.network: 0.03500000000000003
android.permission.WRITE_CALENDAR: 0.0326666666666667
android.permission.CALL_PHONE: 0.03200000000000003
android.permission.READ_CALENDAR: 0.0316666666666667
android.hardware.location: 0.0316666666666667
DateTime: 20240206_140138.
