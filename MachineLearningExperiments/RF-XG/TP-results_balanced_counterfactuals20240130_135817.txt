Train set size: (9000, 2640).
Test set size: (1000, 2640).
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
There are 0 constant categorical features and we remove them!
Removed features are: [].
['sha256' 'Malware' 'android.permission.POST_NOTIFICATIONS' ...
 'Lorg/apache/xerces/impl/XMLEntityManager;->startExternalSubset'
 'Lorg/apache/xerces/util/SecurityManager;->getEntityExpansionLimit'
 'Lorg/apache/xerces/util/SecurityManager;->getMaxOccurNodeLimit']
Fitting 5 folds for each of 1 candidates, totalling 5 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 30, 'min_samples_split': 10, 'n_estimators': 1000}
Training Accuracy: 0.7298888888888889, Test Accuracy: 0.507
Training Precision: 0.6500362581580855, Test Precision: 0.1641025641025641
Training Recall: 0.996, Test Recall: 0.96
Training F1 Score: 0.7866608161474329, Test F1 Score: 0.28029197080291973
Training ROC-AUC: 0.8096473827160494, Test ROC-AUC: 0.7724055555555556
Training Confusion Matrix:
[[2087 2413]
 [  18 4482]]
Test Confusion Matrix:
[[411 489]
 [  4  96]]
              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63       900
     Malware       0.16      0.96      0.28       100

    accuracy                           0.51      1000
   macro avg       0.58      0.71      0.45      1000
weighted avg       0.91      0.51      0.59      1000

              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63      4500
     Malware       0.65      1.00      0.79      4500

    accuracy                           0.73      9000
   macro avg       0.82      0.73      0.71      9000
weighted avg       0.82      0.73      0.71      9000

The number of TPs is 96.
TP indices: [13, 27, 28, 29, 38, 43, 46, 86, 102, 109, 112, 117, 133, 145, 152, 154, 173, 190, 207, 212, 218, 222, 228, 231, 237, 251, 257, 258, 272, 289, 290, 296, 305, 308, 347, 349, 378, 385, 388, 399, 406, 411, 442, 463, 472, 475, 476, 477, 503, 505, 508, 518, 545, 561, 569, 575, 605, 616, 618, 620, 627, 628, 630, 637, 639, 643, 646, 654, 657, 659, 662, 678, 709, 720, 732, 734, 743, 746, 749, 754, 767, 786, 792, 793, 794, 801, 816, 837, 872, 875, 899, 916, 917, 941, 945, 970]
The number of FNs is 4.
FN indices: [14, 107, 188, 555]
Creating Counterfactuals....
Random TP: 945
Malware: 1
Column Name: android.hardware.camera
Column Name: android.hardware.camera.autofocus
Column Name: android.hardware.sensor.accelerometer
Column Name: android.hardware.sensor.compass
Generating Counterfactuals....
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
android.intent.action.MAIN: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->openAssetFileDescriptor: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
android.permission.ACCESS_WIFI_STATE: Original=0, Counterfactual=1
android.intent.action.SEND_MULTIPLE: Original=0, Counterfactual=1
Landroid/os/PowerManager;->isPowerSaveMode: Original=0, Counterfactual=1
Counterfactual 3 (Changed Features):
android.permission.ACCESS_WIFI_STATE: Original=0, Counterfactual=1
android.intent.action.SEND_MULTIPLE: Original=0, Counterfactual=1
Landroid/app/ActivityManager;->getRunningTasks: Original=0, Counterfactual=1
Landroid/os/PowerManager;->isPowerSaveMode: Original=0, Counterfactual=1
Counterfactual 4 (Changed Features):
android.intent.action.MAIN: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->openAssetFileDescriptor: Original=0, Counterfactual=1
Landroid/os/Bundle;->clear: Original=0, Counterfactual=1
Counterfactual 5 (Changed Features):
android.intent.action.VIEW: Original=0, Counterfactual=1
Landroid/os/Bundle;->putDoubleArray: Original=0, Counterfactual=1
Counterfactual 6 (Changed Features):
android.intent.action.VIEW: Original=0, Counterfactual=1
Landroid/bluetooth/BluetoothGattCharacteristic;->getProperties: Original=0, Counterfactual=1
Landroid/content/Intent;->putStringArrayListExtra: Original=0, Counterfactual=1
Counterfactual 7 (Changed Features):
android.intent.action.MAIN: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->openAssetFileDescriptor: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->registerContentObserver: Original=0, Counterfactual=1
Landroid/os/Bundle;->clear: Original=0, Counterfactual=1
Counterfactual 8 (Changed Features):
android.intent.action.VIEW: Original=0, Counterfactual=1
Landroid/bluetooth/BluetoothGattCharacteristic;->getProperties: Original=0, Counterfactual=1
Landroid/content/Context;->isRestricted: Original=0, Counterfactual=1
Landroid/content/Intent;->putStringArrayListExtra: Original=0, Counterfactual=1
Counterfactual 9 (Changed Features):
android.intent.action.MAIN: Original=0, Counterfactual=1
Landroid/app/Activity;->closeOptionsMenu: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->openAssetFileDescriptor: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->registerContentObserver: Original=0, Counterfactual=1
Landroid/os/Bundle;->clear: Original=0, Counterfactual=1
Counterfactual 10 (Changed Features):
android.intent.action.VIEW: Original=0, Counterfactual=1
Landroid/os/Bundle;->putDoubleArray: Original=0, Counterfactual=1
Ljava/net/HttpURLConnection;->getContentEncoding: Original=0, Counterfactual=1
Random FN: 555
Malware: 1
Column Name: android.hardware.camera
Column Name: android.hardware.camera.autofocus
Column Name: android.hardware.gamepad
Column Name: android.hardware.location.gps
Column Name: android.hardware.location.network
Column Name: android.hardware.screen.landscape
Column Name: android.hardware.touchscreen
Column Name: android.hardware.usb.host
Column Name: android.software.leanback
Local feature importance:
DateTime: 20240130_135817.
