Train set size: (9000, 2640).
Test set size: (1000, 2640).
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
There are 0 constant categorical features and we remove them!
Removed features are: [].
['sha256' 'Malware' 'android.permission.POST_NOTIFICATIONS' ...
 'Lorg/apache/xerces/impl/XMLEntityManager;->startExternalSubset'
 'Lorg/apache/xerces/util/SecurityManager;->getEntityExpansionLimit'
 'Lorg/apache/xerces/util/SecurityManager;->getMaxOccurNodeLimit']
Fitting 5 folds for each of 1 candidates, totalling 5 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 30, 'min_samples_split': 10, 'n_estimators': 1000}
Training Accuracy: 0.7301111111111112, Test Accuracy: 0.508
Training Precision: 0.65022486580589, Test Precision: 0.16552901023890784
Training Recall: 0.996, Test Recall: 0.97
Training F1 Score: 0.7867989116123935, Test F1 Score: 0.282798833819242
Training ROC-AUC: 0.8089905925925926, Test ROC-AUC: 0.7715166666666667
Training Confusion Matrix:
[[2089 2411]
 [  18 4482]]
Test Confusion Matrix:
[[411 489]
 [  3  97]]
              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63       900
     Malware       0.17      0.97      0.28       100

    accuracy                           0.51      1000
   macro avg       0.58      0.71      0.45      1000
weighted avg       0.91      0.51      0.59      1000

              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63      4500
     Malware       0.65      1.00      0.79      4500

    accuracy                           0.73      9000
   macro avg       0.82      0.73      0.71      9000
weighted avg       0.82      0.73      0.71      9000

The number of TPs is 97.
TP indices: [13, 14, 27, 28, 29, 38, 43, 46, 86, 102, 109, 112, 117, 133, 145, 152, 154, 173, 190, 207, 212, 218, 222, 228, 231, 237, 251, 257, 258, 272, 289, 290, 296, 305, 308, 347, 349, 378, 385, 388, 399, 406, 411, 442, 463, 472, 475, 476, 477, 503, 505, 508, 518, 545, 561, 569, 575, 605, 616, 618, 620, 627, 628, 630, 637, 639, 643, 646, 654, 657, 659, 662, 678, 709, 720, 732, 734, 743, 746, 749, 754, 767, 786, 792, 793, 794, 801, 816, 837, 872, 875, 899, 916, 917, 941, 945, 970]
The number of FNs is 3.
FN indices: [107, 188, 555]
Creating Counterfactuals....
Random TP: 616
Malware: 1
Column Name: android.hardware.bluetooth
Column Name: android.hardware.camera
Column Name: android.hardware.type.television
Column Name: android.hardware.location
Column Name: android.hardware.screen.landscape
Column Name: android.hardware.screen.portrait
Column Name: android.hardware.telephony
Column Name: android.hardware.faketouch
Column Name: android.hardware.touchscreen
Column Name: android.hardware.wifi
Column Name: android.software.leanback
Random FN: 107
Malware: 1
Column Name: android.permission.READ_PHONE_STATE
Column Name: android.permission.RECORD_AUDIO
Column Name: android.permission.WRITE_EXTERNAL_STORAGE
Column Name: android.permission.ACCESS_WIFI_STATE
Column Name: android.permission.READ_LOGS
Column Name: android.hardware.microphone
Column Name: android.intent.action.MAIN
Column Name: android.intent.action.VIEW
Column Name: Landroid/content/Context;->getClassLoader
Column Name: Landroid/content/Context;->getFilesDir
Column Name: Landroid/content/Context;->getPackageName
Column Name: Landroid/content/Context;->getResources
Column Name: Landroid/content/res/AssetManager;->open
Column Name: Ljava/io/FileInputStream;->close
Column Name: Ljava/io/FileInputStream;->read
Column Name: Ljava/io/FileOutputStream;->flush
Column Name: Ljava/io/FileOutputStream;->write
Column Name: Ljava/io/RandomAccessFile;->close
Column Name: Ljava/lang/StringBuilder;->append
Column Name: Ljava/lang/StringBuilder;->toString
Column Name: Ljava/lang/System;->currentTimeMillis
Column Name: Ljava/lang/System;->exit
Column Name: Ljava/lang/System;->load
Column Name: Ljava/lang/System;->loadLibrary
Generating Counterfactuals....
No Counterfactuals found for the given configuration, perhaps try with different parameters... ; total time taken: 03 min 27 sec
