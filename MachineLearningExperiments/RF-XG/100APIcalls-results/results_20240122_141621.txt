Size of data frame that contains API Calls is (9000, 2290).
The original number of API Calls is 2290.
Number of manifest properties is 350.
Number of selected API Calls is 100.
 The total number of selected features is 448.

 Selected features: ['sha256', 'Malware', 'android.permission.POST_NOTIFICATIONS', 'android.permission.ACCEPT_HANDOVER', 'android.permission.ACCESS_BACKGROUND_LOCATION', 'android.permission.ACCESS_COARSE_LOCATION', 'android.permission.ACCESS_FINE_LOCATION', 'android.permission.ACCESS_MEDIA_LOCATION', 'android.permission.ACTIVITY_RECOGNITION', 'com.android.voicemail.permission.ADD_VOICEMAIL', 'android.permission.ANSWER_PHONE_CALLS', 'android.permission.BLUETOOTH_ADVERTISE', 'android.permission.BLUETOOTH_CONNECT', 'android.permission.BLUETOOTH_SCAN', 'android.permission.BODY_SENSORS', 'android.permission.BODY_SENSORS_BACKGROUND', 'android.permission.CALL_PHONE', 'android.permission.CAMERA', 'android.permission.GET_ACCOUNTS', 'android.permission.NEARBY_WIFI_DEVICES', 'android.permission.PROCESS_OUTGOING_CALLS', 'android.permission.READ_CALENDAR', 'android.permission.READ_CALL_LOG', 'android.permission.READ_CONTACTS', 'android.permission.READ_EXTERNAL_STORAGE', 'android.permission.READ_MEDIA_AUDIO', 'android.permission.READ_MEDIA_IMAGES', 'android.permission.READ_MEDIA_VIDEO', 'android.permission.READ_MEDIA_VISUAL_USER_SELECTED', 'android.permission.READ_PHONE_NUMBERS', 'android.permission.READ_PHONE_STATE', 'android.permission.READ_SMS', 'android.permission.RECEIVE_MMS', 'android.permission.RECEIVE_SMS', 'android.permission.RECEIVE_WAP_PUSH', 'android.permission.RECORD_AUDIO', 'android.permission.SEND_SMS', 'android.permission.USE_SIP', 'android.permission.UWB_RANGING', 'android.permission.WRITE_CALENDAR', 'android.permission.WRITE_CALL_LOG', 'android.permission.WRITE_CONTACTS', 'android.permission.WRITE_EXTERNAL_STORAGE', 'android.permission.BIND_DEVICE_ADMIN', 'android.permission.SYSTEM_ALERT_WINDOW', 'android.permission.IND_ACCESSIBILITY_SERVICE', 'android.permission.BIND_NOTIFICATION_LISTENER_SERVICE', 'android.permission.ACCESS_WIFI_STATE', 'android.permission.CHANGE_NETWORK_STATE', 'android.permission.CHANGE_WIFI_STATE', 'android.permission.DISABLE_KEYGUARD', 'android.permission.GET_TASKS', 'android.permission.INSTALL_PACKAGES', 'com.android.browser.permission.READ_HISTORY_BOOKMARKS', 'android.permission.READ_LOGS', 'android.permission.RECEIVE_BOOT_COMPLETED', 'android.permission.RESTART_PACKAGES', 'android.permission.SET_WALLPAPER', 'android.permission.WRITE_APN_SETTINGS', 'android.permission.WRITE_SETTINGS', 'android.hardware.audio.low_latency', 'android.hardware.audio.output', 'android.hardware.audio.pro', 'android.hardware.microphone', 'android.hardware.bluetooth', 'android.hardware.bluetooth_le', 'android.hardware.camera', 'android.hardware.camera.any', 'android.hardware.camera.autofocus', 'android.hardware.camera.capability.manual_post_processing', 'android.hardware.camera.capability.manual_sensor', 'android.hardware.camera.capability.raw', 'android.hardware.camera.external', 'android.hardware.camera.flash', 'android.hardware.camera.front', 'android.hardware.camera.level.full', 'android.hardware.type.automotive', 'android.hardware.type.television', 'android.hardware.type.watch', 'android.hardware.fingerprint', 'android.hardware.gamepad', 'android.hardware.consumerir', 'android.hardware.location', 'android.hardware.location.gps', 'android.hardware.location.network', 'android.hardware.nfc', 'android.hardware.nfc.hce', 'android.hardware.opengles.aep', 'android.hardware.sensor.accelerometer', 'android.hardware.sensor.ambient_temperature', 'android.hardware.sensor.barometer', 'android.hardware.sensor.compass', 'android.hardware.sensor.gyroscope', 'android.hardware.sensor.hifi_sensors', 'android.hardware.sensor.heartrate', 'android.hardware.sensor.heartrate.ecg', 'android.hardware.sensor.light', 'android.hardware.sensor.proximity', 'android.hardware.sensor.relative_humidity', 'android.hardware.sensor.stepcounter', 'android.hardware.sensor.stepdetector', 'android.hardware.screen.landscape', 'android.hardware.screen.portrait', 'android.hardware.telephony', 'android.hardware.telephony.cdma', 'android.hardware.telephony.gsm', 'android.hardware.faketouch', 'android.hardware.faketouch.multitouch.distinct', 'android.hardware.faketouch.multitouch.jazzhand', 'android.hardware.touchscreen', 'android.hardware.touchscreen.multitouch', 'android.hardware.touchscreen.multitouch.distinct', 'android.hardware.touchscreen.multitouch.jazzhand', 'android.hardware.usb.accessory', 'android.hardware.usb.host', 'android.hardware.vulkan.compute', 'android.hardware.vulkan.level', 'android.hardware.vulkan.version', 'android.hardware.wifi', 'android.hardware.wifi.direct', 'android.software.sip', 'android.software.sip.voip', 'android.software.webview', 'android.software.input_methods', 'android.software.backup', 'android.software.device_admin', 'android.software.managed_users', 'android.software.securely_removes_users', 'android.software.verified_boot', 'android.software.midi', 'android.software.print', 'android.software.leanback', 'android.software.live_tv', 'android.software.app_widgets', 'android.software.home_screen', 'android.software.live_wallpaper', 'android.intent.action.MAIN', 'android.intent.action.VIEW', 'android.intent.extra.FROM_STORAGE', 'android.intent.action.QUICK_VIEW', 'android.intent.action.ATTACH_DATA', 'android.intent.action.EDIT', 'android.intent.action.INSERT_OR_EDIT', 'android.intent.action.PICK', 'android.intent.action.CREATE_SHORTCUT', 'android.intent.extra.shortcut.INTENT', 'android.intent.extra.shortcut.NAME', 'android.intent.extra.shortcut.ICON', 'android.intent.action.CHOOSER', 'android.intent.action.GET_CONTENT', 'android.intent.action.DELETE', 'android.intent.action.DIAL', 'android.intent.action.CALL', 'android.intent.action.CALL_EMERGENCY', 'android.intent.action.CALL_PRIVILEGED', 'android.intent.action.CARRIER_SETUP', 'android.intent.action.SENDTO', 'android.intent.action.SEND', 'android.intent.action.SEND_MULTIPLE', 'android.intent.action.ANSWER', 'android.intent.action.INSERT', 'android.intent.action.PASTE', 'android.intent.action.DELETE.1', 'android.intent.action.RUN', 'android.intent.action.SYNC', 'android.intent.action.PICK_ACTIVITY', 'android.intent.action.SEARCH', 'android.intent.action.SYSTEM_TUTORIAL', 'android.intent.action.WEB_SEARCH', 'android.intent.action.ASSIST', 'android.intent.action.VOICE_ASSIST', 'android.intent.action.ALL_APPS', 'android.intent.action.SET_WALLPAPER', 'android.intent.action.BUG_REPORT', 'android.intent.action.FACTORY_TEST', 'android.intent.action.CALL_BUTTON', 'android.intent.action.VOICE_COMMAND', 'android.intent.action.SEARCH_LONG_PRESS', 'android.intent.action.APP_ERROR', 'android.intent.action.POWER_USAGE_SUMMARY', 'android.intent.action.UPGRADE_SETUP', 'android.intent.action.INSTALL_PACKAGE', 'android.intent.action.INSTALL_FAILURE', 'android.intent.action.UNINSTALL_PACKAGE', 'android.intent.extra.REMOTE_CALLBACK', 'android.intent.extra.PACKAGE_NAME', 'android.intent.extra.SUSPENDED_PACKAGE_EXTRAS', 'android.intent.extra.SPLIT_NAME', 'android.intent.extra.COMPONENT_NAME', 'android.intent.extra.RESULT_NEEDED', 'android.intent.extra.LAUNCHER_EXTRAS', 'android.intent.extra.PERMISSION_NAME', 'android.intent.action.SCREEN_OFF', 'android.intent.action.SCREEN_ON', 'android.intent.action.DREAMING_STOPPED', 'android.intent.action.DREAMING_STARTED', 'android.intent.action.USER_PRESENT', 'android.intent.action.TIME_TICK', 'android.intent.action.TIME_SET', 'android.intent.action.DATE_CHANGED', 'android.intent.action.TIMEZONE_CHANGED', 'android.intent.action.CLEAR_DNS_CACHE', 'android.intent.action.ALARM_CHANGED', 'android.intent.action.LOCKED_BOOT_COMPLETED', 'android.intent.action.BOOT_COMPLETED', 'android.intent.action.CLOSE_SYSTEM_DIALOGS', 'android.intent.action.PACKAGE_INSTALL', 'android.intent.action.PACKAGE_ADDED', 'android.intent.action.PACKAGE_REPLACED', 'android.intent.action.MY_PACKAGE_REPLACED', 'android.intent.action.PACKAGE_REMOVED', 'android.intent.action.PACKAGE_CHANGED', 'android.intent.action.QUERY_PACKAGE_RESTART', 'android.intent.action.PACKAGE_RESTARTED', 'android.intent.action.PACKAGE_DATA_CLEARED', 'android.intent.action.PACKAGES_SUSPENDED', 'android.intent.action.PACKAGES_UNSUSPENDED', 'android.intent.action.MY_PACKAGE_SUSPENDED', 'android.intent.action.MY_PACKAGE_UNSUSPENDED', 'android.intent.action.UID_REMOVED', 'android.intent.action.PACKAGE_FIRST_LAUNCH', 'android.intent.action.PACKAGE_NEEDS_VERIFICATION', 'android.intent.action.PACKAGE_VERIFIED', 'android.intent.action.INTENT_FILTER_NEEDS_VERIFICATION', 'android.intent.action.WALLPAPER_CHANGED', 'android.intent.action.CONFIGURATION_CHANGED', 'android.intent.action.LOCALE_CHANGED', 'android.intent.action.BATTERY_CHANGED', 'android.intent.action.BATTERY_LOW', 'android.intent.action.BATTERY_OKAY', 'android.intent.action.ACTION_POWER_CONNECTED', 'android.intent.action.ACTION_SHUTDOWN', 'android.intent.action.DEVICE_STORAGE_LOW', 'android.intent.action.DEVICE_STORAGE_OK', 'android.intent.action.DEVICE_STORAGE_FULL', 'android.intent.action.DEVICE_STORAGE_NOT_FULL', 'android.intent.action.MANAGE_PACKAGE_STORAGE', 'android.intent.action.UMS_CONNECTED', 'android.intent.action.UMS_DISCONNECTED', 'android.intent.action.MEDIA_REMOVED', 'android.intent.action.MEDIA_UNMOUNTED', 'android.intent.action.MEDIA_CHECKING', 'android.intent.action.MEDIA_NOFS', 'android.intent.action.MEDIA_MOUNTED', 'android.intent.action.MEDIA_SHARED', 'android.intent.action.MEDIA_UNSHARED', 'android.intent.action.MEDIA_BAD_REMOVAL', 'android.intent.action.MEDIA_UNMOUNTABLE', 'android.intent.action.MEDIA_EJECT', 'android.intent.action.MEDIA_SCANNER_STARTED', 'android.intent.action.MEDIA_SCANNER_FINISHED', 'android.intent.action.MEDIA_SCANNER_SCAN_FILE', 'android.intent.action.MEDIA_BUTTON', 'android.intent.action.CAMERA_BUTTON', 'android.intent.action.AIRPLANE_MODE', 'android.intent.action.USER_UNLOCKED', 'android.intent.action.GLOBAL_BUTTON', 'android.intent.action.OVERLAY_CHANGED', 'android.intent.action.OPEN_DOCUMENT', 'android.intent.action.CREATE_DOCUMENT', 'android.intent.action.MASTER_CLEAR', 'android.intent.action.FACTORY_RESET', 'android.intent.action.PROCESS_TEXT', 'android.intent.action.SIM_STATE_CHANGED', 'android.intent.action.SERVICE_STATE', 'android.intent.extra.SERVICE_STATE', 'android.intent.extra.PROCESS_TEXT', 'android.intent.action.THERMAL_EVENT', 'android.intent.extra.THERMAL_STATE', 'android.intent.action.DOCK_IDLE', 'android.intent.action.DOCK_ACTIVE', 'android.intent.category.DEFAULT', 'android.intent.category.BROWSABLE', 'android.intent.category.VOICE', 'android.intent.category.ALTERNATIVE', 'android.intent.category.SELECTED_ALTERNATIVE', 'android.intent.category.TAB', 'android.intent.category.LAUNCHER', 'android.intent.category.LEANBACK_LAUNCHER', 'android.intent.category.CAR_LAUNCHER', 'android.intent.category.LEANBACK_SETTINGS', 'android.intent.category.INFO', 'android.intent.category.HOME', 'android.intent.category.HOME_MAIN', 'android.intent.category.SETUP_WIZARD', 'android.intent.category.LAUNCHER_APP', 'android.intent.category.PREFERENCE', 'android.intent.category.DEVELOPMENT_PREFERENCE', 'android.intent.category.EMBED', 'android.intent.category.APP_MARKET', 'android.intent.category.MONKEY', 'android.intent.category.TEST', 'android.intent.category.UNIT_TEST', 'android.intent.category.SAMPLE_CODE', 'android.intent.category.OPENABLE', 'android.intent.category.CAR_DOCK', 'android.intent.category.DESK_DOCK', 'android.intent.category.LE_DESK_DOCK', 'android.intent.category.HE_DESK_DOCK', 'android.intent.category.CAR_MODE', 'android.intent.category.VR_HOME', 'android.intent.category.APP_BROWSER', 'android.intent.category.APP_CALCULATOR', 'android.intent.category.APP_CALENDAR', 'android.intent.category.APP_CONTACTS', 'android.intent.category.APP_EMAIL', 'android.intent.category.APP_GALLERY', 'android.intent.category.APP_MAPS', 'android.intent.category.APP_MESSAGING', 'android.intent.category.APP_MUSIC', 'android.intent.extra.TEMPLATE', 'android.intent.extra.TEXT', 'android.intent.extra.HTML_TEXT', 'android.intent.extra.STREAM', 'android.intent.extra.EMAIL', 'android.intent.extra.CC', 'android.intent.extra.BCC', 'android.intent.extra.SUBJECT', 'android.intent.extra.INTENT', 'android.intent.extra.USER_ID', 'android.intent.extra.TASK_ID', 'android.intent.extra.ALTERNATE_INTENTS', 'android.intent.extra.CHOOSER_TARGETS', 'android.intent.extra.TITLE', 'android.intent.extra.INITIAL_INTENTS', 'android.intent.extra.EPHEMERAL_SUCCESS', 'android.intent.extra.EPHEMERAL_FAILURE', 'android.intent.extra.EPHEMERAL_HOSTNAME', 'android.intent.extra.EPHEMERAL_TOKEN', 'android.intent.extra.INSTANT_APP_ACTION', 'android.intent.extra.VERSION_CODE', 'android.intent.extra.LONG_VERSION_CODE', 'android.intent.extra.CHOSEN_COMPONENT', 'android.intent.extra.KEY_EVENT', 'android.intent.extra.KEY_CONFIRM', 'android.intent.extra.DONT_KILL_APP', 'android.intent.extra.PHONE_NUMBER', 'android.intent.extra.UID', 'android.intent.extra.PACKAGES', 'android.intent.extra.DATA_REMOVED', 'android.intent.extra.REPLACING', 'android.intent.extra.ALARM_COUNT', 'android.intent.extra.DOCK_STATE', 'android.intent.extra.BUG_REPORT', 'android.intent.extra.restrictions_list', 'android.intent.extra.MIME_TYPES', 'android.intent.extra.REASON', 'android.intent.extra.WIPE_EXTERNAL_STORAGE', 'android.intent.extra.INDEX', 'android.intent.extra.QUIET_MODE', 'Landroid/app/Activity;->findViewById', 'Landroid/app/Activity;->finish', 'Landroid/app/Activity;->getComponentName', 'Landroid/app/Activity;->getIntent', 'Landroid/app/Activity;->getWindow', 'Landroid/app/Activity;->onCreate', 'Landroid/app/Activity;->onSaveInstanceState', 'Landroid/app/Activity;->requestPermissions', 'Landroid/app/Activity;->startActivityForResult', 'Landroid/app/NotificationManager;->notify', 'Landroid/content/ContentProvider;->attachInfo', 'Landroid/content/ContentResolver;->openInputStream', 'Landroid/content/ContentResolver;->query', 'Landroid/content/Context;->bindService', 'Landroid/content/Context;->createPackageContext', 'Landroid/content/Context;->getApplicationContext', 'Landroid/content/Context;->getApplicationInfo', 'Landroid/content/Context;->getAssets', 'Landroid/content/Context;->getCacheDir', 'Landroid/content/Context;->getClassLoader', 'Landroid/content/Context;->getContentResolver', 'Landroid/content/Context;->getExternalFilesDirs', 'Landroid/content/Context;->getFilesDir', 'Landroid/content/Context;->getMainLooper', 'Landroid/content/Context;->getPackageManager', 'Landroid/content/Context;->getPackageName', 'Landroid/content/Context;->getResources', 'Landroid/content/Context;->getSharedPreferences', 'Landroid/content/Context;->getSystemService', 'Landroid/content/Context;->registerReceiver', 'Landroid/content/Context;->sendBroadcast', 'Landroid/content/Context;->startActivity', 'Landroid/content/Context;->startService', 'Landroid/content/Context;->unbindService', 'Landroid/content/Context;->unregisterReceiver', 'Landroid/content/Intent;->addCategory', 'Landroid/content/Intent;->addFlags', 'Landroid/content/Intent;->getAction', 'Landroid/content/Intent;->getData', 'Landroid/content/Intent;->getExtras', 'Landroid/content/Intent;->getIntExtra', 'Landroid/content/Intent;->getParcelableExtra', 'Landroid/content/Intent;->getStringExtra', 'Landroid/content/Intent;->hasExtra', 'Landroid/content/Intent;->putExtra', 'Landroid/content/Intent;->putExtras', 'Landroid/content/Intent;->setAction', 'Landroid/content/Intent;->setClassName', 'Landroid/content/Intent;->setComponent', 'Landroid/content/Intent;->setData', 'Landroid/content/Intent;->setFlags', 'Landroid/content/Intent;->setPackage', 'Landroid/content/Intent;->setType', 'Landroid/content/pm/PackageManager;->getActivityInfo', 'Landroid/content/pm/PackageManager;->getApplicationInfo', 'Landroid/content/pm/PackageManager;->getApplicationLabel', 'Landroid/content/pm/PackageManager;->getPackageInfo', 'Landroid/content/pm/PackageManager;->hasSystemFeature', 'Landroid/content/pm/PackageManager;->queryIntentActivities', 'Landroid/content/pm/PackageManager;->queryIntentServices', 'Landroid/content/pm/PackageManager;->resolveContentProvider', 'Landroid/content/res/AssetManager;->open', 'Landroid/location/Location;->getLatitude', 'Landroid/location/Location;->getLongitude', 'Landroid/location/LocationManager;->isProviderEnabled', 'Landroid/net/Uri;->decode', 'Landroid/net/Uri;->encode', 'Landroid/net/Uri;->getEncodedPath', 'Landroid/net/Uri;->getScheme', 'Landroid/net/Uri;->parse', 'Landroid/net/Uri;->toString', 'Landroid/os/Bundle;->getBoolean', 'Landroid/os/Bundle;->getInt', 'Landroid/os/Bundle;->getLong', 'Landroid/os/Bundle;->getParcelable', 'Landroid/os/Bundle;->getString', 'Landroid/os/Bundle;->getStringArrayList', 'Landroid/os/Bundle;->putBoolean', 'Landroid/os/Bundle;->putInt', 'Landroid/os/Bundle;->putParcelable', 'Landroid/os/Bundle;->putString', 'Landroid/os/Bundle;->putStringArrayList', 'Landroid/os/Environment;->getExternalStorageDirectory', 'Landroid/os/PowerManager;->newWakeLock', 'Landroid/view/inputmethod/InputMethodManager;->hideSoftInputFromWindow', 'Landroid/view/inputmethod/InputMethodManager;->showSoftInput', 'Ljava/io/BufferedReader;->close', 'Ljava/io/BufferedReader;->readLine', 'Ljava/io/FileInputStream;->close', 'Ljava/io/FileInputStream;->read', 'Ljava/io/FileOutputStream;->close', 'Ljava/io/FileOutputStream;->write', 'Ljava/lang/StringBuilder;->append', 'Ljava/lang/StringBuilder;->delete', 'Ljava/lang/StringBuilder;->length', 'Ljava/lang/StringBuilder;->toString', 'Ljava/lang/System;->currentTimeMillis', 'Ljava/lang/System;->loadLibrary', 'Ljava/lang/System;->nanoTime', 'Ljava/net/URL;->openConnection'].
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
Fitting 5 folds for each of 150 candidates, totalling 750 fits
Fitting 5 folds for each of 576 candidates, totalling 2880 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 30, 'min_samples_split': 2, 'n_estimators': 100}
Training Accuracy: 0.7334444444444445, Test Accuracy: 0.512
Training Precision: 0.6528444638440274, Test Precision: 0.16551724137931034
Training Recall: 0.9971111111111111, Test Recall: 0.96
Training F1 Score: 0.7890618130660336, Test F1 Score: 0.2823529411764706
Training ROC-AUC: 0.8146401728395061, Test ROC-AUC: 0.7734166666666668
Training Confusion Matrix:
[[2114 2386]
 [  13 4487]]
Test Confusion Matrix:
[[416 484]
 [  4  96]]
              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63       900
     Malware       0.17      0.96      0.28       100

    accuracy                           0.51      1000
   macro avg       0.58      0.71      0.46      1000
weighted avg       0.91      0.51      0.60      1000

              precision    recall  f1-score   support

      Benign       0.99      0.47      0.64      4500
     Malware       0.65      1.00      0.79      4500

    accuracy                           0.73      9000
   macro avg       0.82      0.73      0.71      9000
weighted avg       0.82      0.73      0.71      9000

================XGB BOOST RESULTS===================:
Best Parameters:  {'colsample_bytree': 1.0, 'learning_rate': 0.3, 'max_depth': 3, 'n_estimators': 200, 'subsample': 1.0}
Precision (Malware): 0.16695352839931152
Recall (Malware): 0.97
F1 Score (Malware): 0.28487518355359764
Training Accuracy: 0.7276666666666667, Test Accuracy: 0.513
Training Precision: 0.6489315307457479, Test Precision: 0.16695352839931152
Training Recall: 0.992, Test Recall: 0.97
Training F1 Score: 0.7846032164513578, Test F1 Score: 0.28487518355359764
Training ROC-AUC: 0.805678049382716, Test ROC-AUC: 0.7814055555555556
Training Confusion Matrix:
[[2085 2415]
 [  36 4464]]
Test Confusion Matrix:
[[416 484]
 [  3  97]]
              precision    recall  f1-score   support

      Benign       0.99      0.46      0.63       900
     Malware       0.17      0.97      0.28       100

    accuracy                           0.51      1000
   macro avg       0.58      0.72      0.46      1000
weighted avg       0.91      0.51      0.60      1000

              precision    recall  f1-score   support

      Benign       0.98      0.46      0.63      4500
     Malware       0.65      0.99      0.78      4500

    accuracy                           0.73      9000
   macro avg       0.82      0.73      0.71      9000
weighted avg       0.82      0.73      0.71      9000

DateTime: 20240122_141621.
