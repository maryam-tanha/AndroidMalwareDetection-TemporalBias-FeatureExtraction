Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
enable_class_weight: True
Fitting 5 folds for each of 150 candidates, totalling 750 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 40, 'min_samples_split': 5, 'n_estimators': 200}
Training Accuracy: 0.9955555555555555, Test Accuracy: 0.965
Training Precision: 0.9584221748400853, Test Precision: 0.8350515463917526
Training Recall: 0.9988888888888889, Test Recall: 0.81
Training F1 Score: 0.9782372143634385, Test F1 Score: 0.8223350253807107
Training ROC-AUC: 0.9995872427983539, Test ROC-AUC: 0.9893888888888889
Training Confusion Matrix:
[[8061   39]
 [   1  899]]
Test Confusion Matrix:
[[884  16]
 [ 19  81]]
For test dataset:
True Negatives (TN): 884
False Positives (FP): 16
False Negatives (FN): 19
True Positives (TP): 81
              precision    recall  f1-score   support

      Benign       0.98      0.98      0.98       900
     Malware       0.84      0.81      0.82       100

    accuracy                           0.96      1000
   macro avg       0.91      0.90      0.90      1000
weighted avg       0.96      0.96      0.96      1000

SHA256 hashes for False Positives (FP): ['14A73616C253A37E64C2795DAAA11B863B5E096103AD146151B9F5E672154AF2', '208A926D0028622E4CF3866D4722EB0D6560039BB66DC86018092D34979E28F6', '9376F4301997DE108EFD8C291FC46DD8DD6BF43655A15450B4DEE44483DD6702', 'AE09BA5993732270CB4746A9DA4AC1B9DEC21571207960E2E321F4939481B794', 'BF014D931F6C17BBD43AEA875BF49D0321EE99FE501CA2B2FF3620F8144E7DEE', '6641B0AEAC8988150BB6BFAC91DB8E25760BDB0DFC2A45A5440F0DFD757FF2F1', '92C2E8D881F1BD64F242D3C2D81103F2FCF1C0C0619D1A50481CE08DE70C74DE', 'D9B3234CE5074BF9F5086D225523278E06C777C4937061864A0083875F8727BD', '530090E6AF917DDA5CD671722C76254C914437F705B66D7B0B7E8DB7DBED2ACF', 'AF11CE0F186DA2BB5EEA37C0877FA71B16919356B6D35051209AEE5627444981', '575DFB84572C4B0B5801A7541D0ABD665A6A84486568C35E747C58A73E8C33CF', 'A2E6CD4D946065E5E4B16669E6F3D009D291E81A9EF77C7D6AEA9348F380F86C', '4476B29C32EE2AE7AABB567703C083156CA3EE309D8D48445DB8003247023EBA', '400F7170A4923FEB7FD776CB5C357CD16D122FD794447D3174F36A971A80851E', '6DFD8EA686EA4561CA189303C0A69340063EBC01F7B961B9F6B3ABC971EB2C53', 'B36A02AC08A87BFB57233924DCDA9EAFB4214F4A00D2583D066ED2F5BD19B84F']
Number of False Positives (FP): 16
SHA256 hashes for False Negatives (FN): ['91d9c7c2c1398412089fed91bd26cb8effd97235df3fc81e0c863ae082544cc3', '93f59905fceda82b2968fdfc8649ec0d0638bbc13b0463dc70a663f4db101b57', 'bc56d4862361826a88ac05841c4bba0e8163c42b2c1661e628746960962dbce9', '9e88752e51f4c1e9b72512992b50080a5b461825f5c3a032e992721498b86450', '72d2af0f8dbefffd126c548dd1c6847a55cb8b4462497d164c6512c72d5ce248', '92f10cba389fa4a151e3e71ab45d0e23b615b5069142e7a6bce31c95849c98aa', '751c950571be6ebaa2b8b1d562b32c319470fa4479d3177c165da1508f6a6fd0', 'be072e7288ced8170692d12014f94c4d2681218802a999bd9a5fa7a2c3fe832c', '72a1fc0da71d33313245e1f51f32a87970277847743662a779cef9c3f637966d', '74dcf11054c78d7c3a8349d48f0680ec8513aac538fa1cff1b37cdf19a04e3a9', '73e8b7e1db6ba76bcc05c7e7d8dad4431e11550feb1ea3d09b3c36b081980ba2', 'bf8f98de37a75e7bcc3d8bee58120e23729a191bb6e29345cabefc20bcb00e1b', '95b3acbdd7c62bce47e3f8d21907ae957999e59dc39e9b276ebe25cb61e186e4', '75e09eed61e35a8a011c0b64ddd2480c8b636a1afe2d862da13bcdfe102524d6', '72ab0a5d84697cf93006821270e4d268217c326809dfddeea86541fa17dd0fab', 'bc5e9840910d7c3cd3981230218fdd8a2fd092fee0f96abdf35840c071b6e9e5', '93f94feebea2207c3089b8dbdc45a6cd4f7a9fe4a5c2067dfa84de93b79e57a7', 'ba7d0f6fd4a1bea0bf9a536f4ab90fa84660f320524252c6d8ad7866aa6e98c0', 'bc5bdb448a371ea7fde06f7c9cb3de493ba5efdf8ffa92a80080784f068dee59']
Number of False Negatives (FN): 19
Number of True Negatives (TN): 884
Number of True Positives (TP): 81
Filtered FN indices: [20, 77, 142, 377, 417, 512, 529, 575, 585, 589, 651, 661, 689, 774, 790, 848, 869, 882, 939]
Number of filtered FNs: 19
Filtered FP indices: [8, 75, 133, 175, 253, 406, 454, 613, 623, 659, 665, 902, 919, 956]
Number of filtered FPs: 14

-------------------------------------------------------------

Creating Counterfactuals....
CF parametrs: {'total_CFs': 1, 'desired_class': 'opposite', 'proximity_weight': 1.5, 'diversity_weight': 1.0}
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 20
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.CAMERA: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 77
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.RECEIVE_BOOT_COMPLETED: Original=1, Counterfactual=0
Landroid/os/PowerManager;->isInteractive: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 142
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_EXTERNAL_STORAGE: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 377
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
Landroid/telephony/TelephonyManager;->getDeviceId: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getNeighboringCellInfo: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 417
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
Landroid/telephony/TelephonyManager;->getSimOperatorName: Original=1, Counterfactual=0
Landroid/app/ActivityManager;->killBackgroundProcesses: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 512
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.RECEIVE_SMS: Original=0, Counterfactual=1
android.permission.BIND_NOTIFICATION_LISTENER_SERVICE: Original=0, Counterfactual=1
android.permission.CHANGE_WIFI_STATE: Original=0, Counterfactual=1
Ljava/net/URLConnection;->getContentType: Original=1, Counterfactual=0
Landroid/app/ActivityManager;->getRunningAppProcesses: Original=1, Counterfactual=0
Landroid/app/ActivityManager;->isLowRamDevice: Original=1, Counterfactual=0
Landroid/bluetooth/BluetoothAdapter;->getAddress: Original=0, Counterfactual=1
Landroid/net/wifi/WifiManager;->getConnectionInfo: Original=0, Counterfactual=1
Landroid/os/PowerManager;->isScreenOn: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 529
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_BACKGROUND_LOCATION: Original=0, Counterfactual=1
android.permission.DISABLE_KEYGUARD: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getCellLocation: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getNetworkCountryIso: Original=1, Counterfactual=0
Landroid/telephony/TelephonyManager;->getSimOperator: Original=1, Counterfactual=0
Landroid/content/ContentResolver;->bulkInsert: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->delete: Original=0, Counterfactual=1
Landroid/app/ActivityManager;->getRunningAppProcesses: Original=1, Counterfactual=0
Landroid/app/ActivityManager;->isLowRamDevice: Original=1, Counterfactual=0
Landroid/location/LocationManager;->getLastKnownLocation: Original=1, Counterfactual=0
Landroid/location/LocationManager;->requestLocationUpdates: Original=0, Counterfactual=1
Landroid/os/PowerManager;->isInteractive: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 575
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_COARSE_LOCATION: Original=0, Counterfactual=1
android.permission.BODY_SENSORS: Original=0, Counterfactual=1
android.permission.PROCESS_OUTGOING_CALLS: Original=0, Counterfactual=1
android.permission.READ_SMS: Original=0, Counterfactual=1
android.permission.WRITE_EXTERNAL_STORAGE: Original=0, Counterfactual=1
android.permission.SYSTEM_ALERT_WINDOW: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getCellLocation: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->getType: Original=1, Counterfactual=0
Ljava/lang/Runtime;->maxMemory: Original=1, Counterfactual=0
Ljava/net/URLConnection;->getContent: Original=0, Counterfactual=1
Landroid/net/wifi/WifiManager;->addNetwork: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 585
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_CALENDAR: Original=1, Counterfactual=0
Ljava/net/HttpURLConnection;->getContentEncoding: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 589
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.CHANGE_NETWORK_STATE: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 651
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.CHANGE_WIFI_STATE: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 661
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_COARSE_LOCATION: Original=0, Counterfactual=1
com.android.voicemail.permission.ADD_VOICEMAIL: Original=0, Counterfactual=1
android.permission.READ_SMS: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getCallState: Original=0, Counterfactual=1
Landroid/content/ContentResolver;->query: Original=1, Counterfactual=0
Ljava/lang/Runtime;->maxMemory: Original=1, Counterfactual=0
Ljava/net/URLConnection;->getDefaultUseCaches: Original=0, Counterfactual=1
Landroid/location/LocationManager;->addNmeaListener: Original=0, Counterfactual=1
Landroid/net/wifi/WifiManager;->getConfiguredNetworks: Original=0, Counterfactual=1
Landroid/net/wifi/WifiManager;->getConnectionInfo: Original=0, Counterfactual=1
Landroid/content/pm/PackageManager;->checkPermission: Original=1, Counterfactual=0
Landroid/os/PowerManager;->isInteractive: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 689
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_SMS: Original=0, Counterfactual=1
android.permission.RECEIVE_SMS: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getNetworkOperatorName: Original=0, Counterfactual=1
Ljava/net/HttpURLConnection;->getResponseCode: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 774
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.CAMERA: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 790
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
Landroid/location/LocationManager;->getBestProvider: Original=0, Counterfactual=1
Landroid/os/PowerManager;->isInteractive: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 848
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
com.android.voicemail.permission.ADD_VOICEMAIL: Original=0, Counterfactual=1
android.permission.ANSWER_PHONE_CALLS: Original=0, Counterfactual=1
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.SET_WALLPAPER: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getNeighboringCellInfo: Original=0, Counterfactual=1
Ljava/net/URLConnection;->getURL: Original=1, Counterfactual=0
Landroid/app/DownloadManager;->query: Original=0, Counterfactual=1
Landroid/net/wifi/WifiManager;->removeNetwork: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 869
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.PROCESS_OUTGOING_CALLS: Original=0, Counterfactual=1
Ljava/lang/Runtime;->getRuntime: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 882
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.BLUETOOTH_ADVERTISE: Original=0, Counterfactual=1
Landroid/telephony/TelephonyManager;->getCellLocation: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 939
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
Ljava/lang/Runtime;->maxMemory: Original=0, Counterfactual=1
--------------------
DateTime: 20240216_104059.
--------------------
