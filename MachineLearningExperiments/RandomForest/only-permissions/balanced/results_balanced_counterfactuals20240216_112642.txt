Train set size: (9000, 60).
Test set size: (1000, 60).
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
Fitting 5 folds for each of 150 candidates, totalling 750 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 20, 'min_samples_split': 2, 'n_estimators': 200}
Training Accuracy: 0.9481111111111111, Test Accuracy: 0.916
Training Precision: 0.969937077604288, Test Precision: 0.5512820512820513
Training Recall: 0.9248888888888889, Test Recall: 0.86
Training F1 Score: 0.946877488340348, Test F1 Score: 0.671875
Training ROC-AUC: 0.9877008641975309, Test ROC-AUC: 0.9601777777777778
Training Confusion Matrix:
[[4371  129]
 [ 338 4162]]
Test Confusion Matrix:
[[830  70]
 [ 14  86]]
For test dataset:
True Negatives (TN): 830
False Positives (FP): 70
False Negatives (FN): 14
True Positives (TP): 86
              precision    recall  f1-score   support

      Benign       0.98      0.92      0.95       900
     Malware       0.55      0.86      0.67       100

    accuracy                           0.92      1000
   macro avg       0.77      0.89      0.81      1000
weighted avg       0.94      0.92      0.92      1000

SHA256 hashes for False Positives (FP): ['54752BD6305D54E0EF4F67B040309BB0D62FB76B7BE60C71120E9F53CDA01A86', '8F88FBA21A55C263543224BB842492CD7A2A9C48FAB44F7ECC767398846CBDE8', '25E7D22DB8882B069415566B6C82F7A80CDDEE4548DF97A7BE3F7B7D465F276D', '7643ECFC04D14A256F608E59FA3CBFACBF57E94189AC2E61598AA32D245B0874', '5EA36E4DD44B4495960E11582D08030E6F11047F1A7C458B7ED7D7018AF2E71D', 'CB75CEC495223228FDB2D87DCC20604BBA196235C530DC5D0687EFFDBE75B1A8', '402BF8AF5BA649566A682EE661B6335A9E0CF4035B3319D80CF344C57B218C38', 'C92B03EE6E2E03119E266925208772459CB891A452D9C29278820E783C24C6FF', 'DD428A5088E0999C592B333D8D505F6C8C55D00676152CDFB446E0ADB0326F9A', '557A9A21594C10AF1DB165E5594EA492A0C3E515E7B2E59E363E673536A98706', '9D999B2630221F5B7265D1A1AE1933CD524DE6C3DFFC922D164980C35551EB91', '52CE978CFDF642DD72DCE942C99B6E866BC47DA7CE4224C8D0E02AA20087790C', '5C354F8D717093561F1FFBAF9F53D8B886AC364FACCC63E25D5DB43F5FAFD31B', '2F03890C7B6EE6E800E44B6C55578E2CCDC4700DBFC12E737E8A9DC9873C0A47', 'F2027879DE22A2EA2FBBBEB8FE6452569E0390146DEEFA97A5D758CCD75C5A30', '2102DC0167C7F40CDB18FE56F7F10E3C4FAC4453632804AFEB7744946C6A0790', '2E6B80FD5CA7211CAC9D8FD61206089370E880ACE522BCAC041136C8B6303E70', '5C73D1100D0DA4CE6DD5C8B82AF6A896FD9160AA36622E36EB1CDF2F4C088173', '633E386416FDB6B31EF3AA029DB2313C86B2D49B026CD5B3B2CC4234D2429E30', '9DD341ACDC1CD32A12DACBB3444669E8086AD7F09B2CEA9F7FD2876D75301CC7', '65A5E49DED365F8AD4B7482DD00AE118298F4BF75EC15DA53131D64D3C62240D', '4EDD6E1B39BF80BDEDF666D99E8CA354EB831291653D936628DC324524BF2135', '852F456C37E7C81B6C1195FB2004C040DD87241FA1550626710796D93F7673BC', 'A533F74CA2219954FF856741D0D7E96F302BF4AD477CD50FC7E3E22B302030A5', '924CA874C4D2D529BE60FBB5B34FEAD45B499628CFD5DB5A7FF400F2EC804E65', 'DB522F08BADF69FFE8B9287F31A0F568B6314DD6A8EB0938B293F2CFE9565A85', '87ECB5C6E96A0E28B6703D6A37A9C5521F273911D9C0B047D5683D0790B161B1', '3804BA5ED8FE989DAE12CE092615B2720A35D3C2A8C966B1069085411CEF5AC5', 'CB2DA1BD178E3759868317F8FED3E73E71A70E7C8057851109DFC4D1BD7B957B', 'FBDF9E64A08E6E2EF6DFEC388588686CA426760666244406850716EBB89ADDD3', 'C7D4B778D1C90E4A0D8CD671F3DD67A19D7BE32206745F10DA61D61ACBFE7A1B', '9519670AC31D63E07909C2A37EED27BAF28B885E28ABF177D7FE87CE1DB3BB6D', 'E3D68389A6E39E37C35C3022038DCC3DC11B5F902FA7C66BE8583CC3783133D2', 'F63891446369432858B1138E87143DAEE21050E3EA54BFFED0252A6E57F30C09', '5A2E37CC497D9F218411E333B70E082E3C1D8E53E7A2E4DDBD049C99A4BE885D', '9C92FAD2CAA184F158D3ADA64B969210A1A4F1671C877FE311AABB2B7FDD17BE', '3C4F9A38DE064C46672246A48637C5D2C8FC6D978192984F046E70EF015FF501', '9B965FCCB7C06F2EC72D1A264E7534F8860CE181930A9580204AFC827A829211', '14AA38EA4035461EBD0A005EC030168D3B2BD491568216B783DF88F272B1B3ED', '56B6CE3E4BC242F359BC0865E4A13CF5D9F03A2E851C9DC4C8D42229119DABCB', '768A317D026CBB70191CD567ACFD9784F87C8A637EB14230D6E1F3B70D371BEF', '782C28BC90D5DF5060E72E6D6843D1D7F2AC7E519AFD6AC7D1262DFAE9629CC8', '77504C1B6C8AB17160D74D657BDE92D01811AFBA2A052267CA1A23C25AB7CE2D', '6990D84A4F1DA9A91877B1E55EA76A21A575F7C03B7448B10591E0C4C0A42822', 'C8BFC35291B954C4663909BAA687738993701F26490590BDC7B187EDE4354910', 'BCE95C59E3BAF3806553F64DBA7D7513815AD709A73B48D6E03CD1A126360A60', '4BD8B83C2E7EA1CCF04799DBEE0C30CF56CD1DFE55CB98726027E8BA0D864375', '35B1094A1ECB701BBF53FDEE43128C61C7C87079D96D0D2A902ED636787A25F6', 'ADAE04FEADFC4E6730D959E80783CDB09363298F27E33DA19E05C21A3ABBDB55', '0835904F54DE4CDF50D7BE90F08701237D4326B31997D1687AEBA2B5AB5FD1AF', '8C8CBBF4CAE4C1A0C738E6FBDD0D5A7D108662EB998D94D0678600688E37F783', '7C847D41E29699B9BCEA1D3BC45EF09B1463A469BF2813D7FF69777CB7408D5D', '6B59778423373D70A8065053A0DD41CD4BC6F1611A6F31B42720E1B90AF2B88B', '3766D59C649D1EE2279CCD36B6A4A28BDA0471044702BF37D2825A8B4C4476C5', '67DB977F97D7944853C104D598DCBE134A459C525EAF9A18645A7C55856260B1', '722312AB3A46D0184A26C7E39AF371E08AC1FC767D708F5B34E3C0057F46FE91', 'C5439ACD7FB2F14F34560F4FABBED9DCF4EE034F3FAA4BA6064A6C0435DCCE21', '5FB1C72E6DBAFE374DBB91E86356344CDD1CB4D63991E80A12A0369D1BFC15AF', '52A08EFAC16D2283C7C03F90C9E76D775A5CAE196980A5D005EDB921289C9389', '789DEE2B3EF7158C4B0EE113E6FFAC00C2B15D994A0DDDFDBAF91BA13439C2F7', '8079F6563DF1FE3798D4B26C099AB13B50881D7081E044FDF2C04B6C3DEB1439', '78B91A0F7A661AB06168CF2A7183C7E3E8D5F98053FB2F0816767DD5052AF23A', 'C438DE7FE49F8ED09A9DD90EBD26585C39FCA4089FC3F5D84F04F1A5164D7B7E', '85E0E2C15F19D6013ECE8711BDD4C5FFAA87756A47DC7D4440F5E97DDC5F6CEB', '99FBCD25A3F6419663218308B9DFFB65ACDC2DF7DA21A2453ADABE83E68A8185', '5D4616EEED0F643F984A08BD27EFFDC4E883D2A1DF028BC329F54F299563C20E', '38029004BFE553A4AF3F045E6EB6D6B8590FA658E05E4AE3575D7CEBC74A9E7B', 'FA1D2B73CED1E6ED1CA2B9F311F5E93CD7AF7437AC069D05C05F3EBEA125C750', '4A116210CC9255B241AFFE0F54CBDBF5CC414C2FF790C779DFE14E9A24E9CFBD', '6A9A689282AB998C79CE72D4D067F3F904705693C85EF70C3CE37F00E92412DE']
Number of False Positives (FP): 70
SHA256 hashes for False Negatives (FN): ['95fa6626b8f994b8421d731359253c4852de52d85bf23489c13628dbe64cab6d', '9718bc21fa44a8cc90c10205b2792a526974bbf23d94822cd147c472c6971627', 'bf131f037f12912d1d387298f0454090828c188f94f751b7dbebef88ef69c6bc', 'bae0b44e39770c65ac0690811d6b0e1aff028529f2f3a32ec40df5f4b3251c8c', '73eb423b916f5291cb0e1fd68889b4617ed0ae6c1a7d657520e4c7354cf5828d', 'bfc2d4586ca90ef1e633e320d3a089e6c84e974c34f0467ba90363877c4a0bea', 'bdcff0db0a772338af2611004bfb5e7a57c9351d4b2ab871a380fb3aec04c1ec', '73e17493c0056a4efcc17bd2ea1a54e1ff2bb7e1c970371b065a7d296fe032f8', '93ca540d5ee1d918d809d2299e9b8db3778e2db86b2a3aae576b9dc839b82246', '97a1080461ee7d7e6e018e6386ffe79f723216ace802590edca8e3ae1f63ad60', '72d530c21a734d087ffb5fb41dfe1441bb838b10d024a4412d14ce028c50fa9d', 'bb8940863eba67cabd66c703fac6f72a883518d1a548c28d870da9ca034e6657', '95b6503a315dbe31ef172e106b1f55662891985567306ac5aa1ad6a7b70db088', '937a72fa7b9e77522c7e534f2f699e9ed2b9fb2e1132dbbf582600e4532cd1ab']
Number of False Negatives (FN): 14
Number of True Negatives (TN): 830
Number of True Positives (TP): 86
Filtered FN indices: [38, 102, 145, 289, 406, 508, 518, 605, 637, 746, 816]
Number of filtered FNs: 11
Filtered FP indices: [30, 47, 82, 83, 88, 115, 130, 131, 138, 150, 160, 176, 194, 209, 227, 247, 248, 253, 274, 301, 302, 303, 313, 321, 329, 334, 379, 410, 415, 422, 450, 464, 471, 479, 497, 509, 512, 515, 523, 541, 577, 600, 666, 667, 672, 681, 685, 712, 724, 733, 753, 756, 778, 785, 800, 802, 811, 817, 828, 881, 882, 883, 903, 930, 933, 934, 944, 946, 959, 975]
Number of filtered FPs: 70

-------------------------------------------------------------

Creating Counterfactuals....
CF parametrs: {'total_CFs': 2, 'desired_class': 'opposite', 'proximity_weight': 1.5, 'diversity_weight': 1.0}
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 38
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_WIFI_STATE: Original=1, Counterfactual=0
android.permission.WRITE_SETTINGS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.GET_ACCOUNTS: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 102
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_CONTACTS: Original=1, Counterfactual=0
android.permission.READ_EXTERNAL_STORAGE: Original=1, Counterfactual=0
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.READ_SMS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 145
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_COARSE_LOCATION: Original=1, Counterfactual=0
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.CAMERA: Original=1, Counterfactual=0
android.permission.READ_MEDIA_AUDIO: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 289
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.WRITE_CALL_LOG: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.WRITE_APN_SETTINGS: Original=0, Counterfactual=1
android.permission.WRITE_SETTINGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 406
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_MEDIA_AUDIO: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.RECEIVE_SMS: Original=0, Counterfactual=1
android.permission.BIND_NOTIFICATION_LISTENER_SERVICE: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 508
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.PROCESS_OUTGOING_CALLS: Original=0, Counterfactual=1
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.READ_SMS: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 518
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.ACCESS_FINE_LOCATION: Original=1, Counterfactual=0
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 605
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.BLUETOOTH_ADVERTISE: Original=0, Counterfactual=1
android.permission.READ_SMS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.RECEIVE_SMS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 637
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.CHANGE_WIFI_STATE: Original=0, Counterfactual=1
com.android.browser.permission.READ_HISTORY_BOOKMARKS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.GET_ACCOUNTS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 746
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_EXTERNAL_STORAGE: Original=0, Counterfactual=1
android.permission.DISABLE_KEYGUARD: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.RECEIVE_SMS: Original=0, Counterfactual=1
android.permission.BIND_NOTIFICATION_LISTENER_SERVICE: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 816
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.CHANGE_NETWORK_STATE: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
--------------------------------------------
android.permission.GET_TASKS: Original=0, Counterfactual=1
android.permission.RESTART_PACKAGES: Original=0, Counterfactual=1
--------------------
DateTime: 20240216_112642.
--------------------
