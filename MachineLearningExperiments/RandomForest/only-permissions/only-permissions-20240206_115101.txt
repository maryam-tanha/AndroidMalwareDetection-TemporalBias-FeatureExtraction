Train set size: (9000, 60).
Test set size: (1000, 60).
TRAINING SET: Ratio of Benign APKs to Malware APKs:
1    0.5
0    0.5
Name: Malware, dtype: float64
TEST SET: Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
There are 0 constant categorical features and we remove them!
Removed features are: [].
['sha256' 'Malware' 'android.permission.POST_NOTIFICATIONS'
 'android.permission.ACCEPT_HANDOVER'
 'android.permission.ACCESS_BACKGROUND_LOCATION'
 'android.permission.ACCESS_COARSE_LOCATION'
 'android.permission.ACCESS_FINE_LOCATION'
 'android.permission.ACCESS_MEDIA_LOCATION'
 'android.permission.ACTIVITY_RECOGNITION'
 'com.android.voicemail.permission.ADD_VOICEMAIL'
 'android.permission.ANSWER_PHONE_CALLS'
 'android.permission.BLUETOOTH_ADVERTISE'
 'android.permission.BLUETOOTH_CONNECT'
 'android.permission.BLUETOOTH_SCAN' 'android.permission.BODY_SENSORS'
 'android.permission.BODY_SENSORS_BACKGROUND'
 'android.permission.CALL_PHONE' 'android.permission.CAMERA'
 'android.permission.GET_ACCOUNTS'
 'android.permission.NEARBY_WIFI_DEVICES'
 'android.permission.PROCESS_OUTGOING_CALLS'
 'android.permission.READ_CALENDAR' 'android.permission.READ_CALL_LOG'
 'android.permission.READ_CONTACTS'
 'android.permission.READ_EXTERNAL_STORAGE'
 'android.permission.READ_MEDIA_AUDIO'
 'android.permission.READ_MEDIA_IMAGES'
 'android.permission.READ_MEDIA_VIDEO'
 'android.permission.READ_MEDIA_VISUAL_USER_SELECTED'
 'android.permission.READ_PHONE_NUMBERS'
 'android.permission.READ_PHONE_STATE' 'android.permission.READ_SMS'
 'android.permission.RECEIVE_MMS' 'android.permission.RECEIVE_SMS'
 'android.permission.RECEIVE_WAP_PUSH' 'android.permission.RECORD_AUDIO'
 'android.permission.SEND_SMS' 'android.permission.USE_SIP'
 'android.permission.UWB_RANGING' 'android.permission.WRITE_CALENDAR'
 'android.permission.WRITE_CALL_LOG' 'android.permission.WRITE_CONTACTS'
 'android.permission.WRITE_EXTERNAL_STORAGE'
 'android.permission.BIND_DEVICE_ADMIN'
 'android.permission.SYSTEM_ALERT_WINDOW'
 'android.permission.IND_ACCESSIBILITY_SERVICE'
 'android.permission.BIND_NOTIFICATION_LISTENER_SERVICE'
 'android.permission.ACCESS_WIFI_STATE'
 'android.permission.CHANGE_NETWORK_STATE'
 'android.permission.CHANGE_WIFI_STATE'
 'android.permission.DISABLE_KEYGUARD' 'android.permission.GET_TASKS'
 'android.permission.INSTALL_PACKAGES'
 'com.android.browser.permission.READ_HISTORY_BOOKMARKS'
 'android.permission.READ_LOGS'
 'android.permission.RECEIVE_BOOT_COMPLETED'
 'android.permission.RESTART_PACKAGES' 'android.permission.SET_WALLPAPER'
 'android.permission.WRITE_APN_SETTINGS'
 'android.permission.WRITE_SETTINGS']
Fitting 5 folds for each of 150 candidates, totalling 750 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 20, 'min_samples_split': 2, 'n_estimators': 100}
Training Accuracy: 0.948, Test Accuracy: 0.918
Training Precision: 0.9699300699300699, Test Precision: 0.5584415584415584
Training Recall: 0.9246666666666666, Test Recall: 0.86
Training F1 Score: 0.9467576791808874, Test F1 Score: 0.6771653543307087
Training ROC-AUC: 0.9878565679012347, Test ROC-AUC: 0.9599
Training Confusion Matrix:
[[4371  129]
 [ 339 4161]]
Test Confusion Matrix:
[[832  68]
 [ 14  86]]
              precision    recall  f1-score   support

      Benign       0.98      0.92      0.95       900
     Malware       0.56      0.86      0.68       100

    accuracy                           0.92      1000
   macro avg       0.77      0.89      0.82      1000
weighted avg       0.94      0.92      0.93      1000

              precision    recall  f1-score   support

      Benign       0.93      0.97      0.95      4500
     Malware       0.97      0.92      0.95      4500

    accuracy                           0.95      9000
   macro avg       0.95      0.95      0.95      9000
weighted avg       0.95      0.95      0.95      9000

Indices of False Positives (FP): [30, 47, 82, 83, 88, 115, 130, 131, 138, 150, 176, 194, 209, 227, 247, 248, 253, 274, 302, 303, 313, 321, 329, 334, 379, 410, 415, 422, 450, 464, 471, 479, 509, 512, 515, 523, 541, 577, 600, 666, 667, 672, 681, 685, 712, 724, 733, 753, 756, 778, 785, 800, 802, 811, 817, 828, 881, 882, 883, 903, 905, 930, 933, 934, 944, 946, 959, 975]
Number of False Positives (FP): 68
Indices of False Negatives (FN): [38, 102, 145, 289, 406, 475, 508, 518, 605, 618, 630, 637, 746, 816]
Number of False Negatives (FN): 14
Indices of True Negatives (TN): [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 44, 45, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 84, 85, 87, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 103, 104, 105, 106, 108, 110, 111, 113, 114, 116, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 132, 134, 135, 136, 137, 139, 140, 141, 142, 143, 144, 146, 147, 148, 149, 151, 153, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 174, 175, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 189, 191, 192, 193, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 208, 210, 211, 213, 214, 215, 216, 217, 219, 220, 221, 223, 224, 225, 226, 229, 230, 232, 233, 234, 235, 236, 238, 239, 240, 241, 242, 243, 244, 245, 246, 249, 250, 252, 254, 255, 256, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 273, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 291, 292, 293, 294, 295, 297, 298, 299, 300, 301, 304, 306, 307, 309, 310, 311, 312, 314, 315, 316, 317, 318, 319, 320, 322, 323, 324, 325, 326, 327, 328, 330, 331, 332, 333, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 348, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 380, 381, 382, 383, 384, 386, 387, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 400, 401, 402, 403, 404, 405, 407, 408, 409, 412, 413, 414, 416, 417, 418, 419, 420, 421, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 443, 444, 445, 446, 447, 448, 449, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 465, 466, 467, 468, 469, 470, 473, 474, 478, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 504, 506, 507, 510, 511, 513, 514, 516, 517, 519, 520, 521, 522, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 542, 543, 544, 546, 547, 548, 549, 550, 551, 552, 553, 554, 556, 557, 558, 559, 560, 562, 563, 564, 565, 566, 567, 568, 570, 571, 572, 573, 574, 576, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 601, 602, 603, 604, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 617, 619, 621, 622, 623, 624, 625, 626, 629, 631, 632, 633, 634, 635, 636, 638, 640, 641, 642, 644, 645, 647, 648, 649, 650, 651, 652, 653, 655, 656, 658, 660, 661, 663, 664, 665, 668, 669, 670, 671, 673, 674, 675, 676, 677, 679, 680, 682, 683, 684, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 710, 711, 713, 714, 715, 716, 717, 718, 719, 721, 722, 723, 725, 726, 727, 728, 729, 730, 731, 735, 736, 737, 738, 739, 740, 741, 742, 744, 745, 747, 748, 750, 751, 752, 755, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 779, 780, 781, 782, 783, 784, 787, 788, 789, 790, 791, 795, 796, 797, 798, 799, 803, 804, 805, 806, 807, 808, 809, 810, 812, 813, 814, 815, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 829, 830, 831, 832, 833, 834, 835, 836, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 873, 874, 876, 877, 878, 879, 880, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 900, 901, 902, 904, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 931, 932, 935, 936, 937, 938, 939, 940, 942, 943, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 971, 972, 973, 974, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999]
Number of True Negatives (TN): 832
Indices of True Positives (TP): [13, 14, 27, 28, 29, 43, 46, 86, 107, 109, 112, 117, 133, 152, 154, 173, 188, 190, 207, 212, 218, 222, 228, 231, 237, 251, 257, 258, 272, 290, 296, 305, 308, 347, 349, 378, 385, 388, 399, 411, 442, 463, 472, 476, 477, 503, 505, 545, 555, 561, 569, 575, 616, 620, 627, 628, 639, 643, 646, 654, 657, 659, 662, 678, 709, 720, 732, 734, 743, 749, 754, 767, 786, 792, 793, 794, 801, 837, 872, 875, 899, 916, 917, 941, 945, 970]
Number of True Positives (TP): 86
Filtered FN indices: [38, 102, 145, 289, 406, 508, 518, 605, 637, 746, 816]
Number of filtered FNs: 11
Filtered FP indices: [30, 47, 82, 83, 88, 115, 130, 131, 138, 150, 176, 194, 209, 227, 247, 248, 253, 274, 302, 303, 313, 321, 329, 334, 379, 410, 415, 422, 450, 464, 471, 479, 509, 512, 515, 523, 541, 577, 600, 666, 667, 672, 681, 685, 712, 724, 733, 753, 756, 778, 785, 800, 802, 811, 817, 828, 881, 882, 883, 903, 905, 930, 933, 934, 944, 946, 959, 975]
Number of filtered FPs: 68
--------------------Permutation importance for RF ------------------------
Baseline Recall: 0.86
<class 'numpy.ndarray'>
android.permission.READ_PHONE_STATE: 0.20799999999999993
android.permission.CAMERA: 0.031333333333333345
android.permission.READ_PHONE_NUMBERS: 0.02500000000000001
android.permission.SYSTEM_ALERT_WINDOW: 0.018666666666666675
android.permission.GET_TASKS: 0.015000000000000013
android.permission.CHANGE_WIFI_STATE: 0.01466666666666668
android.permission.ACCESS_FINE_LOCATION: 0.013000000000000012
android.permission.BLUETOOTH_CONNECT: 0.009000000000000008
android.permission.WRITE_EXTERNAL_STORAGE: 0.00833333333333334
android.permission.READ_CALENDAR: 0.007666666666666673
android.permission.ACCESS_WIFI_STATE: 0.006000000000000005
android.permission.ACTIVITY_RECOGNITION: 0.005666666666666671
android.permission.GET_ACCOUNTS: 0.005666666666666671
android.permission.ACCESS_BACKGROUND_LOCATION: 0.0050000000000000044
android.permission.RECEIVE_BOOT_COMPLETED: 0.0043333333333333375
android.permission.RECORD_AUDIO: 0.003333333333333336
android.permission.POST_NOTIFICATIONS: 0.0030000000000000027
android.permission.CALL_PHONE: 0.0023333333333333353
android.permission.ACCESS_MEDIA_LOCATION: 0.0013333333333333346
android.permission.BLUETOOTH_SCAN: 0.0013333333333333346
Creating Counterfactuals....
Malware: 1
Column Name: android.permission.ACCESS_WIFI_STATE
Generating Counterfactuals....
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
android.permission.SYSTEM_ALERT_WINDOW: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Counterfactual 2 (Changed Features):
android.permission.READ_SMS: Original=0, Counterfactual=1
android.permission.USE_SIP: Original=0, Counterfactual=1
Malware: 1
Column Name: android.permission.ACCESS_BACKGROUND_LOCATION
Column Name: android.permission.ACCESS_COARSE_LOCATION
Column Name: android.permission.ACCESS_FINE_LOCATION
Column Name: android.permission.CALL_PHONE
Column Name: android.permission.CAMERA
Column Name: android.permission.READ_CONTACTS
Column Name: android.permission.READ_EXTERNAL_STORAGE
Column Name: android.permission.READ_PHONE_STATE
Column Name: android.permission.RECORD_AUDIO
Column Name: android.permission.WRITE_EXTERNAL_STORAGE
Column Name: android.permission.ACCESS_WIFI_STATE
Column Name: android.permission.CHANGE_NETWORK_STATE
Column Name: android.permission.CHANGE_WIFI_STATE
Column Name: android.permission.GET_TASKS
Column Name: android.permission.RECEIVE_BOOT_COMPLETED
Generating Counterfactuals....
