Ratio of Benign APKs to Malware APKs:
0    0.9
1    0.1
Name: Malware, dtype: float64
enable_class_weight: True
Fitting 5 folds for each of 150 candidates, totalling 750 fits
================RANDOM FOREST RESULTS===================:
Best Parameters:  {'max_depth': 30, 'min_samples_split': 5, 'n_estimators': 1000}
Training Accuracy: 0.973, Test Accuracy: 0.949
Training Precision: 0.8186226964112512, Test Precision: 0.7094017094017094
Training Recall: 0.9377777777777778, Test Recall: 0.83
Training F1 Score: 0.8741584671154842, Test F1 Score: 0.7649769585253456
Training ROC-AUC: 0.9920907407407408, Test ROC-AUC: 0.9443444444444444
Training Confusion Matrix:
[[7913  187]
 [  56  844]]
Test Confusion Matrix:
[[866  34]
 [ 17  83]]
For test dataset:
True Negatives (TN): 866
False Positives (FP): 34
False Negatives (FN): 17
True Positives (TP): 83
              precision    recall  f1-score   support

      Benign       0.98      0.96      0.97       900
     Malware       0.71      0.83      0.76       100

    accuracy                           0.95      1000
   macro avg       0.85      0.90      0.87      1000
weighted avg       0.95      0.95      0.95      1000

SHA256 hashes for False Positives (FP): ['B99570DC3DD87AC66563C5C32C91A3DEF224F2385BE6F2560A28090A546E3508', '2A74783372CDC4BF8081C33EB402C2FE29E44E84ADAD255107D292B4E506A20B', '6641B0AEAC8988150BB6BFAC91DB8E25760BDB0DFC2A45A5440F0DFD757FF2F1', '3A250DE7868F245CF836B260D08E3A79DF38D5C34D12AF65C07E0E90BB5E5756', '0995C5FC6471A3BDC2B5EE34C3E7B12BC23498CC2660963A0B5D06094EBD4602', '3766D59C649D1EE2279CCD36B6A4A28BDA0471044702BF37D2825A8B4C4476C5', 'AD5C6A60D5615BCC8DA6D5A1F5C335D8E5CD86E720D19BAC2DAEA2B3D6BD2660', '72A962C8B333F28CB83F95CC6C58766D17B2F5DF481507000515661AF5B1E1DE', '9095C66A417B9EE4D5137FAB24963365A309536F27C3714FA01BA89832CDA2A8', '2BFDEC92C5FDDE1E6E2E210C93660F78D858D3360332B670DE0B07D4282902EC', '924CA874C4D2D529BE60FBB5B34FEAD45B499628CFD5DB5A7FF400F2EC804E65', 'AFEC9C4EC26AEE8CD29B8F1027800B632A4FB932568337D4E9AADEAB48EF602B', '4B934B79A469BE0343737E8F45CB349F98980260ED5ADC5BB57406A5F4C64118', '7B6D7E0DD0D643ADA7805BA6C11D5CD2B9C541F8F723B621567E76317CA3D847', 'AD46B0B97B3A9B57206E71D3D8213F79B7AC384D2037C05625FD0C9D2AFB2499', '393563BFDC084E3F90C29EB79ED4F14C293AECF1083C183C33D65968E8F0DBEC', '4036F42D8115066B6588D9515D81CF80C32F65971F9508B0E9A3DA124E55F942', 'DD92626A29E7E3EC1684215BA4566606635498C75469BB114AEEDE70A11F0648', 'CE009E81016D5FCEB641E17D2AF528E616B1BB3C3D9FCB9865B22AF254CAD40E', '65B62E9384EE51C593BD1C2F56C443AA536E3CDFD48C8A57DDB3C1EDD8BFB966', 'AF74C717FC820A531CBCE8A26C27F099A5A169FFD34CEA001D38F89268905BD3', 'D0F43A58F796FEC5AAAA65DA84F6FEA2D5AE339BC530EE010BB809DD187B8CC9', 'C83B9F10852E5FA02493B5FE45DF00BB1F1386203C68E5412697371125EA76B9', 'C30B6B0123522638D8790949FB7CC954EB1406BD423721386F965FE3270EDE1E', 'CC8AFB6F24D2275D961AFF0F748E1FE7B3CDC194C7D6290E1CEDA6C2E9D2A4E0', 'D86E75F54FA68F683FB713E07A178BA8AB8C87D62CE9C69D4B04985E04A622C0', '9376F4301997DE108EFD8C291FC46DD8DD6BF43655A15450B4DEE44483DD6702', '2837FB0BE728B09AF56EDD690258BB2D26BA615B7183F2209FF561E55435C095', '6FF84017D17C205604DFBA6A30F8826AC8A27D0463026E0C1F3593C3D516E4DC', 'C1E8FC20F5EAFEB87ADA894DAC95757234B5425C476391C216B7953B519B4786', 'C2E299B97FE5CCEE22B594F7525AE837B2E421EEE16752DFF12ABDD5EB102560', '8C5502CBFF0058B7374EF8A35B703A74BE2B85D762F806A5D8EF73026046A67F', '8D281409ED40EA4A78F2B575C338A9CC96FE4DD07B8F7D28C140A2ECE4180BE3', '3F7C8DB34699E5517668BA4E60BA13B8D926A09F365CF56182C8DB1F067E14C0']
Number of False Positives (FP): 34
SHA256 hashes for False Negatives (FN): ['72cd3a27e2d615960adc189ac38c992e05ceec651c31948778f00889052ee60a', '75748ba34c4dffcf0568468dc6078234b73f7594e7f54112f10005365b3ebfe2', 'bdef2277ec46a8a19e71c7c32e6af9a733d0a288f92302fd916209ee1f29f038', '731ca9dc89e68f2bab7512bf1031bbbec648197796ac980f202b54bb6d037328', '708b19f601a6be860fb7e42d9e8d4584953efc430e9d49ba50463022dcc3b245', '763ae2a438510b242da719276c2472c875dde10502150a6f2e0a7fd3173ed6ca', '74269c23eea57e189c885106efe66c6b41ef78a2825d7d9daf7d9eff6f096aa3', '71b2e455ec556db32bab94e3fafb7b7990bfa4e3450ba2d6c655510b92143b38', 'bbc87f5f89ffe0dd45ebd65e0f2e135109c6ba2c0f59b37a6f45341f5211131a', '7283eccff1fa941f2a897912f9492aec10a2d8c2c42a17f7049ca567606916b8', '73b3f1b189ecdde16aeffbd097ea386bf9d4c5ed698623102db7b8ca3bb62509', '72afb5af295be092862ac66531d2a44d26c5a436bb74bffad76a178ebc5c5e4c', '937a72fa7b9e77522c7e534f2f699e9ed2b9fb2e1132dbbf582600e4532cd1ab', '72ccdaaaab0b382fcba159e654c647791819506f0e3baa6faadc2550449ca33d', '743798f88dc10a2d3c1a2843e70e738f81edc9d31332c2ba148edbcd411123cf', 'bf2e175838c91655eb3a98262e77605ea63ca9f8e00e409bb42265b27bd6e037', '9e6a2c1d3ea158daf4c06bc7200e46a33a7f8c8237b69255f6f2df9939d8dc30']
Number of False Negatives (FN): 17
Number of True Negatives (TN): 866
Number of True Positives (TP): 83
Filtered FN indices: [39, 54, 102, 197, 241, 314, 342, 383, 390, 417, 547, 585, 748, 749, 753, 792, 976]
Number of filtered FNs: 17
Filtered FP indices: [45, 52, 53, 73, 120, 158, 180, 217, 277, 282, 328, 335, 337, 347, 359, 376, 393, 411, 416, 427, 464, 473, 527, 544, 560, 561, 573, 618, 688, 781, 819, 839, 871, 980]
Number of filtered FPs: 34

-------------------------------------------------------------

Creating Counterfactuals....
CF parametrs: {'total_CFs': 1, 'desired_class': 'opposite', 'proximity_weight': 1.5, 'diversity_weight': 1.0}
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 39
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.SEND_SMS: Original=0, Counterfactual=1
android.permission.WRITE_CALENDAR: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 54
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.NEARBY_WIFI_DEVICES: Original=0, Counterfactual=1
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 102
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_COARSE_LOCATION: Original=0, Counterfactual=1
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 197
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_BACKGROUND_LOCATION: Original=1, Counterfactual=0
android.permission.CAMERA: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 241
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.SYSTEM_ALERT_WINDOW: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 314
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.ACCESS_WIFI_STATE: Original=0, Counterfactual=1
android.permission.CHANGE_WIFI_STATE: Original=0, Counterfactual=1
android.permission.WRITE_SETTINGS: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 342
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_CONTACTS: Original=1, Counterfactual=0
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 383
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_EXTERNAL_STORAGE: Original=1, Counterfactual=0
android.permission.RECORD_AUDIO: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 390
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ACCESS_COARSE_LOCATION: Original=0, Counterfactual=1
android.permission.READ_SMS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 417
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_LOGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 547
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.SYSTEM_ALERT_WINDOW: Original=0, Counterfactual=1
android.permission.GET_TASKS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 585
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_MEDIA_VIDEO: Original=0, Counterfactual=1
android.permission.READ_SMS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 748
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.READ_LOGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 749
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.RECEIVE_BOOT_COMPLETED: Original=1, Counterfactual=0
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 753
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.ANSWER_PHONE_CALLS: Original=0, Counterfactual=1
android.permission.DISABLE_KEYGUARD: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 792
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.WRITE_SETTINGS: Original=0, Counterfactual=1
Malware: 1
Generating Counterfactuals....
==================================
Success: Found a CF!
Proximity_weight = 1.5
fn_idx: 976
Counterfactual Explanations:
Counterfactual 1 (Changed Features):
--------------------------------------------
android.permission.READ_PHONE_STATE: Original=0, Counterfactual=1
android.permission.SEND_SMS: Original=0, Counterfactual=1
--------------------
DateTime: 20240216_113424.
--------------------
