import pandas as pd
import sys

#ds_2021 =pd.read_csv("/home/mary/Desktop/combined/2021_50_50_train_dataset.csv")

#ds_2022 =pd.read_csv("/home/mary/Desktop/combined/2022_50_50_train_dataset.csv")

ds_2021 =pd.read_csv("2021_50_50_train_dataset.csv")

ds_2022 =pd.read_csv("2022_50_50_train_dataset.csv")


# create imbalanced combined dataset
#9000 benign apps
new_benign_2021 = ds_2021.iloc[0:4500].copy()
new_benign_2022 = ds_2022.iloc[0:4500].copy()

#1000 malware
new_malware_2021 = ds_2021.iloc[4501:5001].copy()
new_malware_2022 = ds_2022.iloc[4501:5001].copy()

# concatenate vertically
combined_df_imbal = pd.concat([new_benign_2021,new_benign_2022,new_malware_2021 , new_malware_2022])

combined_df_imbal.to_csv('combined_dataset_imbalanced.csv', index=False)


# create balanced combined dataset
#4500 benign apps
new_benign_2021 = ds_2021.iloc[0:2250].copy()
new_benign_2022 = ds_2022.iloc[0:2250].copy()

#4500 malware
new_malware_2021 = ds_2021.iloc[4501:6751].copy()
new_malware_2022 = ds_2022.iloc[4501:6751].copy()



combined_df_bal = pd.concat([new_benign_2021,new_benign_2022,new_malware_2021 , new_malware_2022])

combined_df_bal.to_csv('combined_dataset_balanced.csv', index=False)
