import pandas as pd
import random
import time

random.seed(42) # Seed for reproducibility

data = [] # Generating the dataset

for i in range(250):
    apk_name = f"apk_{i}"
    sha_key = f"sha256_{i}"  # Dummy SHA-256 hash
    timestamp = time.time() - random.randint(0, 1000000)  # Random timestamp
    malware_label = 1 if i < 25 else 0  # First 5 are malware, rest are benign
    frequency_system_calls = random.randint(100, 5000)

    # For simplicity, generating random values for dynamic features
    dns_req = random.randint(0, 100)
    outbound_conn = random.randint(0, 50)
    contacted_domains = random.randint(1, 15)
    data_sent = random.randint(0, 5000)
    data_received = random.randint(0, 5000)
    files_created = random.randint(0, 10)
    files_read = random.randint(0, 15)
    files_deleted = random.randint(0, 5)
    process_spawn = random.randint(0, 10)
    dlls_loaded = random.randint(0, 30)
    intents_sent = random.randint(0, 20)
    intents_received = random.randint(0, 20)
    root_checks = random.randint(0, 5)
    camera_access = random.randint(0, 10)
    mic_access = random.randint(0, 10)
    gps_query = random.randint(0, 50)
    crypto_calls = random.randint(0, 100)
    autostart_created = random.randint(0, 5)
    cpu_usage = random.uniform(0, 100)  # Percentage
    mem_usage = random.uniform(0, 100)  # Percentage

    data.append([apk_name, sha_key, timestamp, malware_label, frequency_system_calls,
                 dns_req, outbound_conn, contacted_domains, data_sent, data_received,
                 files_created, files_read, files_deleted, process_spawn, dlls_loaded,
                 intents_sent, intents_received, root_checks, camera_access, mic_access,
                 gps_query, crypto_calls, autostart_created, cpu_usage, mem_usage])

# Convert to pandas DataFrame
df = pd.DataFrame(data, columns=["APK Name", "SHA Key", "Timestamp", "Malware Label", "Frequency of System Calls",
                                 "Count of DNS requests", "Count of outbound connections", "Domains/IPs contacted",
                                 "Data volume sent", "Data volume received", "Number of files created",
                                 "Number of files read", "Number of files deleted", "Process spawning",
                                 "Loaded DLLs", "Intents sent", "Intents received", "Checks for root privileges",
                                 "Camera access frequency", "Microphone access frequency", "GPS query frequency",
                                 "Frequency of cryptographic API calls", "Autostart entries created",
                                 "CPU usage patterns", "Memory usage patterns"])

# Display the first few rows of the dataset
print(df.head())

df.to_csv('apk_dataset.csv', index=False)