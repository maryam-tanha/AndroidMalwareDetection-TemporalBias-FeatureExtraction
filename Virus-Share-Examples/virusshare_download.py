import requests
from dotenv import load_dotenv
import os

load_dotenv()
virusshare_api_key = os.getenv('VIRUSSHARE_API_KEY')

# set up API endpoint for downloading malware from VirusShare.com
API_URL = "https://virusshare.com/apiv2"


def download_malware(hash):
    """Downloads malware from VirusShare.com using a provided hash"""
    url = f"{API_URL}/download?apikey={virusshare_api_key}&hash={hash}>"
    response = requests.get(url)
    if response.status_code == 200:
        with open(f"{hash}.zip", "wb") as f:
            f.write(response.content)
        print(f"Malware downloaded successfully for hash {hash}")
    else:
        print(f"Error downloading malware for hash {hash}")


# WARNING: Do not run this function unless downloading the malware to a hard disk.
download_malware("some_malware_hash")
