# Static Android Malware Analysis

## 1. Introductory Summary

This repository contains code for a Static Android Malware Analysis tool. The tool focuses on feature extraction from mobile devices to identify potential malicious applications. It provides a set of features that can be used to analyze and detect malware in Android apps. By leveraging static analysis techniques, this tool aims to enhance the detection and understanding of Android malware.

## 2. Execution Steps

To execute the Static Android Malware Analysis tool, follow these steps:

1. Install Android Studio(Dolphin release or a higher version) or another suitable Android development environment.
2. Clone the repository to your local machine using the following command:
3. Open the FeatureExtractionApp project in Android Studio.
4. Build the project to ensure all dependencies are resolved.
5. Connect an Android device or use an emulator to run the application.
6. Launch the FeatureExtractionApp on the device/emulator.

## 3. Output

When you run the FeatureExtractionApp, it performs feature extraction for static analysis on the installed applications on the Android device.
The output of the application includes the extracted features from each app, which can be utilized for further analysis or detection of potential malware.
The specific format or representation of the output may vary based on the implementation and requirements.

More specifically, the app produces the following files for a particular APK:
- appname
  - appname/appname-hw-sw.txt
  - appname/appname-intent-actions.txt
  - appname/appname-permissions.txt
  - appname/appname-api-calls.txt
  - appname/appname-metrics.txt

Also, the app detects the installed applications (non-system apps) and creates a list of those APKs.
- APKsList
  - InstalledAPKsList.txt

#### Emulator Output Location:
1. Click on the "Device File Explorer" button located in the bottom right corner of Android Studio.
2. In the Device File Explorer panel, navigate to sdcard/Android/data/com.example.staticAnalysis/files.
3. Here, you will find the output files corresponding to each APK installed on the emulator.

#### Device Output Location:
1. Click on the Folder Icon for the device connected in the Physical Device Section Device Manager.
2. In the Device File Explorer panel, navigate to sdcard/Android/data/com.example.staticAnalysis/files.
3. Here, you will find the output files corresponding to each APK installed on the emulator.
![img.png](img.png)

## Features

The repository provides a collection of feature extraction techniques implemented for Android malware analysis. 
These features are designed to capture various characteristics of Android applications that can aid in identifying 
potential threats. The features may include:

- **app name**
  - `appname-hw-sw.txt`: Hardware and software requirements specified in the AndroidManifest.xml file of the APK.
  - `appname-intent-actions.txt`: Intents specified in the AndroidManifest.xml file.
  - `appname-permissions.txt`: List of permissions requested by the APK to function to its full capacity.
  - `appname-api-calls.txt`: List of API calls extracted from the Dex files of the APK.
  - `appname-metrics.txt`: Computation of dimensional and complexity metrics.
  
### Time Complexity
- Emulator: The FeatureExtractionApp takes 4-6 seconds to extract all feature from a particular APK and store them in the external directory.
- Samsung Device: The FeatureExtractionApp takes 6-8 seconds to extract all feature from a particular APK and store them in the external directory.

### Usage/Execution Examples 
TODO:
- The slack.apk and whatsapp.apk files are installed onto the emulator for testing purposes.
- All the function calls are written in the onCreate() method.
- The app requests permissions to read from and write to the external directory.
- The Package Manager is utilized to detect the installed APK files on the emulator.
- The APK file path is retrieved using the package name, and the AndroidManifest.xml file is copied into the cache directory after unzipping the APK file.
- The binary AndroidManifest.xml file is read from the cache and processed using the AXML Library.
- Several helper functions are employed to extract permissions, intent filters, and hardware-software requirements from the Manifest file.
- The DexLib2 Library is utilized to decode the Dex files and extract API calls and metrics(dimensional and complexity).
- The text output files are created in the external directory of the emulator/device.
