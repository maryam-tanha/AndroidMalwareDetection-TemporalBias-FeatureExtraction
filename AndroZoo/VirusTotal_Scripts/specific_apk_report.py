import requests
from dotenv import load_dotenv
import os

load_dotenv()
virustotal_api_key = os.getenv('VIRUSTOTAL_API_KEY')

sha256_hash = "a5bf8d6da56aba9152086fd2265752549393d482b0f9663df0fb1e046d8ec2b1"

headers = {
    "accept": "application/json",
    "x-apikey": virustotal_api_key
}

# Make a GET request to the VirusTotal HTTP API to get the report for the AndroZooAPK file
virustotal_endpoint = "https://www.virustotal.com/api/v3/files/" + sha256_hash
response = requests.get(virustotal_endpoint, headers=headers)

if response.status_code == 200:
    # Save the file
    with open("../reports.vt", "wb") as file:
        file.write(response.content)
    print("File saved as reports.vt")
else:
    print("Error downloading the file. Status code:", response.status_code)